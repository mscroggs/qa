<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>Duplicated coordinates with P2 elements - FEniCS Q&amp;A</title>
		<meta name="description" content="I don't understand why the tabulated coordinates are duplicated when using P2 elements. # Mesh details uplim ... for an output of type (dim,N). Thanks">
		<meta name="keywords" content="coordinates,p2">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/14147/duplicated-coordinates-with-p2-elements">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">Duplicated coordinates with P2 elements</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q14147">
								<form method="post" action="../../14147/duplicated-coordinates-with-p2-elements">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_14147">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+1<span class="votes-up"><span class="value-title" title="1"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516466509-99365b637b987de35012374de170dfac2c31d3e6">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../14147/duplicated-coordinates-with-p2-elements">
										<div class="qa-q-view-content">
											<a name="14147"></a><div class="entry-content"><p>I don't understand why the tabulated coordinates are duplicated when using P2 elements.</p>

<pre><code># Mesh details 
uplim = 1
size = 50
# Create Mesh    
domain = Rectangle(Point(0., 0.), Point(uplim, uplim))
mesh = generate_mesh(domain,size)
# Define Function Space
V = VectorFunctionSpace(mesh, 'CG', pdim, dim=2)

# Cartesian coordinates:
dim = V.dim()
print dim
N = mesh.geometry().dim()
coor = V.tabulate_dof_coordinates().reshape(dim,N)

print coor[0:10,:]
print coor.size
</code></pre>

<p>This shows that each 2D coordinate is doubled. When using p2 elements I would expect a higher number of points (not necessarily doubled with respect to p1 elements), some of which are nodes and some others are edges middle points. </p>

<p>Moreover, what can I use in python to obtain the size of an object as an ndarray? size gives the number of all elements, while I'm looking for an output of type (dim,N). </p>

<p>Thanks </p>
</div>
										</div>
										<div class="qa-q-view-follows">
											related to an answer for:
											<a href="../../7502/extract-solution-from-nodes-of-certain-coordinates?show=7508#a7508" class="qa-q-view-follows-link">Extract solution from nodes of certain coordinates</a>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/coordinates" rel="tag" class="qa-tag-link">coordinates</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/p2" rel="tag" class="qa-tag-link">p2</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../14147/duplicated-coordinates-with-p2-elements" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2017-06-28T15:23:11+0000"></span>Jun 28, 2017</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/caterinabig" class="qa-user-link url nickname">caterinabig</a></span></span>
													<span class="qa-q-view-who-title">FEniCS User</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">1,460</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c14147_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516466509-8110ed7bebe61495b577b1cc5877f682789f0019">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer answer-selected qa-a-list-item-selected" id="a14151">
									<form method="post" action="../../14147/duplicated-coordinates-with-p2-elements">
										<div class="qa-voting qa-voting-net" id="voting_14151">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516466509-99365b637b987de35012374de170dfac2c31d3e6">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../14147/duplicated-coordinates-with-p2-elements">
											<div class="qa-a-item-selected">
												<div class="qa-a-selection">
													<div class="qa-a-selected">&#160;</div>
													<div class="qa-a-selected-text">Best answer</div>
												</div>
												<div class="qa-a-item-content">
													<a name="14151"></a><div class="entry-content"><p>Hi, </p>

<p>to answer your two questions:<br>
1) This is exactly the expected behavior, since you are initializing V as a 2D vector function space (since dim=2). This means that at each dof position, you actually have two components/dofs (or even more, for higher dimensional VectorFunctionSpaces and TensorFunctionSpaces ). So when listing the coordinates of the dofs as in your example, you will indeed observe that different dofs share the same coordinates. </p>

<p>2) To get the shape of an ndarray, simply use:</p>

<pre><code>coor.shape
</code></pre>

<p>returning a tuple of the ndarray shape.</p>
</div>
												</div>
												<span class="qa-a-item-avatar-meta">
													<span class="qa-a-item-meta">
														<a href="../../14147/duplicated-coordinates-with-p2-elements?show=14151#a14151" class="qa-a-item-what">answered</a>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2017-06-28T22:53:04+0000"></span>Jun 29, 2017</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span>
															<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/jmmal" class="qa-user-link url nickname">jmmal</a></span></span>
															<span class="qa-a-item-who-title">FEniCS User</span>
															<span class="qa-a-item-who-points">
																<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">5,890</span><span class="qa-a-item-who-points-pad"> points)</span>
															</span>
														</span>
														<br>
														<span class="qa-a-item-what">selected</span>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="updated"><span class="value-title" title="2017-06-29T13:57:51+0000"></span>Jun 29, 2017</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span><span class="qa-a-item-who-data"><a href="../../user/caterinabig" class="qa-user-link url nickname">caterinabig</a></span>
														</span>
													</span>
												</span>
											</div>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c14151_list">
												<div class="qa-c-list-item  hentry comment" id="c14156">
													<div class="qa-c-item-content">
														<a name="14156"></a><div class="entry-content"><p>Hi, </p>

<p>Thank you, my bad: I confused <code>pdim</code> that indicates the element type (linear/quadratic), with <code>dim</code> that gives the dimension of the system. </p>

<p>The output variable is a 2D vector <code>u=[u_x,u_y]^T</code>, and <code>u_x</code> and <code>u_y</code> share the same coordinate; in which case this would not be the case? I don't understand the interest of having double dofs/components. </p>

<p>My goal is to set a condition over the coordinates and then save the indices of the dofs that correspond to this request. To do so I need to skip all the even entries of coord. </p>

<p>I've done:</p>

<pre><code>xs1 = 0.495
xs2 = 0.505
indices = np.where(np.logical_and(coor_x &gt; xs1, coor_x &lt; xs2))[0]
xs = coor[indices,:] 

vals = u1_proj.vector()[indices] #

source_vec = np.zeros((len(xs)/2,4))
count = 0
for i in range(0,len(xs)-1,2):
    source_vec[count,:] = [ xs[i,0], xs[i,1], vals[i], vals[i+1] ]
    count = count+1
</code></pre>

<p>where <code>u1_proj</code> is defined as <code>u1_proj.vector()[:] = project(u1, V).vector()</code> and u1 is a function given by the sum of the solution and other not relevant stuff for this question.</p>

<p>Is there a better way to do so???</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../14147/duplicated-coordinates-with-p2-elements?show=14156#c14156" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2017-06-29T09:31:27+0000"></span>Jun 29, 2017</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/caterinabig" class="qa-user-link url nickname">caterinabig</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">1,460</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
																<br>
																<span class="qa-c-item-what">edited</span>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="updated"><span class="value-title" title="2017-06-29T09:51:53+0000"></span>Jun 29, 2017</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span><span class="qa-c-item-who-data"><a href="../../user/caterinabig" class="qa-user-link url nickname">caterinabig</a></span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516466509-ddbafa2b65f0c7f975ef9c850b13a18a1df70030">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>