<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>how to define the flux by CG and DG function in UnitInterval - FEniCS Q&amp;A</title>
		<meta name="description" content="hi how could one define the flux in DG while the advection speed is defined in CG space for unitInterval case?">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/1257/how-to-define-the-flux-by-cg-and-dg-function-in-unitinterval">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">how to define the flux by CG and DG function in UnitInterval</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q1257">
								<form method="post" action="../../1257/how-to-define-the-flux-by-cg-and-dg-function-in-unitinterval">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_1257">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">&#8211;2<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="2"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516467829-f3e5e3fb2ac240c2ffe640d7687acc7e543abc00">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../1257/how-to-define-the-flux-by-cg-and-dg-function-in-unitinterval">
										<div class="qa-q-view-content">
											<a name="1257"></a><div class="entry-content"><p>hi<br>
how could one define the flux in DG while the advection speed is defined in CG space for unitInterval case?</p>
</div>
										</div>
										<div class="qa-q-view-follows">
											related to an answer for:
											<a href="../../98/how-can-write-simple-upwind-scheme-using-dg0-and-rt1-elements?show=108#a108" class="qa-q-view-follows-link">How can I write a simple upwind scheme using DG0 and RT1 elements?</a>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../1257/how-to-define-the-flux-by-cg-and-dg-function-in-unitinterval" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2013-09-23T13:42:09+0000"></span>Sep 23, 2013</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/waynezw0618" class="qa-user-link url nickname">waynezw0618</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">450</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c1257_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516467829-53477414afd7ad77149a4a738785ec4820733bd8">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer" id="a1277">
									<form method="post" action="../../1257/how-to-define-the-flux-by-cg-and-dg-function-in-unitinterval">
										<div class="qa-voting qa-voting-net" id="voting_1277">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+1<span class="votes-up"><span class="value-title" title="1"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516467829-f3e5e3fb2ac240c2ffe640d7687acc7e543abc00">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../1257/how-to-define-the-flux-by-cg-and-dg-function-in-unitinterval">
											<div class="qa-a-selection">
											</div>
											<div class="qa-a-item-content">
												<a name="1277"></a><div class="entry-content"><p>Your question is not specific enough to get answers. You can look at demos to see implementations of the numerical flux (e.g., the DG advection-diffusion demo). If you have a particular flux in mind you need to be specific. </p>
</div>
											</div>
											<span class="qa-a-item-avatar-meta">
												<span class="qa-a-item-meta">
													<a href="../../1257/how-to-define-the-flux-by-cg-and-dg-function-in-unitinterval?show=1277#a1277" class="qa-a-item-what">answered</a>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2013-09-25T19:02:57+0000"></span>Sep 25, 2013</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span>
														<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/Garth+N.+Wells" class="qa-user-link url nickname">Garth N. Wells</a></span></span>
														<span class="qa-a-item-who-title">FEniCS Expert</span>
														<span class="qa-a-item-who-points">
															<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">35,930</span><span class="qa-a-item-who-points-pad"> points)</span>
														</span>
													</span>
												</span>
											</span>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c1277_list">
												<div class="qa-c-list-item  hentry comment" id="c1283">
													<div class="qa-c-item-content">
														<a name="1283"></a><div class="entry-content"><p>sorry for I didn't describe the question clearly. I am reading dg-advection-diffusion-demo now, since I want to try a time dependent  problem in 1D domain.as I mentioned by Logg, a simple way to write upwind flux is</p>

<pre><code>flux = dot(jump(Ct), jump(up*C))
</code></pre>

<p>my question are:<br>
 1) I can't understand why it can be write in such manner, since it use the 'exterior'  test function. while for me, the flux is integrate over surface, so there is only 'interior' part of test function.</p>

<p>2)  how could one define 1D flux? for simpler I have a only constant advect velocity inside 1D domain. then I do things as :</p>

<pre><code>from dolfin import *
u0=Expression('1')
mesh=UnitInterval(3)
V_cg=FunctionSpace(mesh,'CG',1)
V_dg=FunctionSpace(mesh,'DG',1)

U=Function(V_cg)
n=FacetNormal(mesh)
un=U*n
up=(un+abs(un))/2.0

U.interpolate(u0)

c=TrialFunction(V_dg)
v=TestFunction(V_dg)

flux=jump(v)*jump(up*c)*dS

print assemble(flux).array()
</code></pre>

<p>but it gives error message as:</p>

<blockquote>
  <p>Trying to integrate expression of rank 1 with free indices ().<br>
  Traceback (most recent call last):<br>
    File "/media/ZHANGWEI/Fenics/1D_DG_upwind_flux.py", line 17, in <br>
      flux=jump(v)<em>jump(up</em>c)<em>dS<br>
    File "/usr/lib/python2.7/dist-packages/ufl/integral.py", line 269, in <strong>rmul</strong><br>
      % (integrand.rank(), integrand.free_indices()))<br>
    File "/usr/lib/python2.7/dist-packages/ufl/log.py", line 154, in error<br>
      raise self._exception_type(self._format_raw(</em>message))<br>
  UFLException: Trying to integrate expression of rank 1 with free indices ().</p>
</blockquote>

<p>thanks in advance!</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../1257/how-to-define-the-flux-by-cg-and-dg-function-in-unitinterval?show=1283#c1283" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2013-09-26T03:18:48+0000"></span>Sep 26, 2013</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/waynezw0618" class="qa-user-link url nickname">waynezw0618</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">450</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516467829-66d39b35b3ef77c31accbece547dee5946628ac2">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>