<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>(1D) space vs time plot - FEniCS Q&amp;A</title>
		<meta name="description" content="Perhaps this is a question better asked on paraview, but, I have solved in FEniCS a PDE in one spatial ...  so I can make such a plot? Thank you.">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/13932/1d-space-vs-time-plot">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">(1D) space vs time plot</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q13932">
								<form method="post" action="../../13932/1d-space-vs-time-plot">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_13932">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516466500-a354b0f9e0b6928474f25611e7c0b12f147656e0">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../13932/1d-space-vs-time-plot">
										<div class="qa-q-view-content">
											<a name="13932"></a><div class="entry-content"><p>Perhaps this is a question better asked on paraview, but,  I have solved in FEniCS a PDE in one spatial dimension and would like to make a plot of the solution in space and time. That is to have the spatial coordinate on the abcissa and time coordinate on the ordinate axis with color representing the value of the function at each coordinate.  I would appreciate any of the following:<br>
  How can I make a setting or filter in paraview that will let me do this?<br>
  How could I do this in a simple python script to accomplish this?<br>
  How can I  read the .vtu or .pvd files into Matlab so I can make such a plot?</p>

<p>Thank you.</p>
</div>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../13932/1d-space-vs-time-plot" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2017-06-13T01:38:42+0000"></span>Jun 13, 2017</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/evan" class="qa-user-link url nickname">evan</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">160</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c13932_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516466500-774025797370e6b4f5e7410c19330285b8896cb0">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">2 Answers</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer" id="a13940">
									<form method="post" action="../../13932/1d-space-vs-time-plot">
										<div class="qa-voting qa-voting-net" id="voting_13940">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516466500-a354b0f9e0b6928474f25611e7c0b12f147656e0">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../13932/1d-space-vs-time-plot">
											<div class="qa-a-selection">
											</div>
											<div class="qa-a-item-content">
												<a name="13940"></a><div class="entry-content"><p>Hello... <br>
I normally import the pvd files into paraview and use the "plot over line" filter... Not sure if that's exactly what you need, but I guess it might help... <br>
Regards</p>
</div>
											</div>
											<span class="qa-a-item-avatar-meta">
												<span class="qa-a-item-meta">
													<a href="../../13932/1d-space-vs-time-plot?show=13940#a13940" class="qa-a-item-what">answered</a>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2017-06-13T15:26:52+0000"></span>Jun 13, 2017</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span>
														<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/lhdamiani" class="qa-user-link url nickname">lhdamiani</a></span></span>
														<span class="qa-a-item-who-title">FEniCS User</span>
														<span class="qa-a-item-who-points">
															<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">2,580</span><span class="qa-a-item-who-points-pad"> points)</span>
														</span>
													</span>
												</span>
											</span>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c13940_list">
												<div class="qa-c-list-item  hentry comment" id="c13942">
													<div class="qa-c-item-content">
														<a name="13942"></a><div class="entry-content"><p>Thank you for your response, but, this is not what I am looking for. I think a picture would help:</p>

<p><img src="http://cdn.iopscience.com/images/1478-3975/2/2/005/Full/pb196256fig06.jpg" alt="picture"></p>

<p>In this case time is on the abscissa and space on the ordinate with a "heat" colormap showing the values of the function.  I am trying to make something like this from the output of the FEniCS package.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../13932/1d-space-vs-time-plot?show=13942#c13942" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2017-06-13T19:39:20+0000"></span>Jun 13, 2017</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/evan" class="qa-user-link url nickname">evan</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">160</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516466500-1837eb9333dd4497c76c7758b6452cdde90d19a1">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
								<div class="qa-a-list-item  hentry answer" id="a13973">
									<form method="post" action="../../13932/1d-space-vs-time-plot">
										<div class="qa-voting qa-voting-net" id="voting_13973">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516466500-a354b0f9e0b6928474f25611e7c0b12f147656e0">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../13932/1d-space-vs-time-plot">
											<div class="qa-a-selection">
											</div>
											<div class="qa-a-item-content">
												<a name="13973"></a><div class="entry-content"><p>While I would like to know how to do this in paraview. Here is a stub code that does what I would like. Note that for long time runs this can be very memory intensive and subsampling is suggested.</p>

<pre><code>import numpy as np
import matplotlib.pyplot as plt
import meshio

direct = '/tmp/'

fileu = direct+'u'+str(0).zfill(6)+'.vtu'
points,cells,point_data,cell_data,field_data = meshio.read(fileu)
xlen = len(points)
xp = [] 
for x in np.linspace(0,xlen-1,xlen):
   xp.append(points[:][int(x)][0])
xp = np.asarray(xp)

tp = np.linspace(0,10,10+1)
U = np.zeros((10+1, xlen))

for filenumber in tp:
   fileu = direct+'u'+str(int(filenumber)).zfill(6)+'.vtu'
   points,cells,point_data,cell_data,field_data = meshio.read(fileu)
   keys = point_data.keys()
   key = keys[0]
   u = point_data[key]
   U[int(filenumber)] = u

U_min = U.min()
U_max = U.max()
plt.figure(1)
plt.clf()
plt.pcolor(xp,tp,U,cmap='jet',vmin=U_min,vmax=U_max)
plt.title('u(x,t)')
plt.axis([xp.min(),xp.max(),tp.min(),tp.max()])
plt.colorbar()
plt.show()
</code></pre>
</div>
											</div>
											<span class="qa-a-item-avatar-meta">
												<span class="qa-a-item-meta">
													<a href="../../13932/1d-space-vs-time-plot?show=13973#a13973" class="qa-a-item-what">answered</a>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2017-06-14T20:26:35+0000"></span>Jun 14, 2017</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span>
														<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/evan" class="qa-user-link url nickname">evan</a></span></span>
														<span class="qa-a-item-who-title">FEniCS Novice</span>
														<span class="qa-a-item-who-points">
															<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">160</span><span class="qa-a-item-who-points-pad"> points)</span>
														</span>
													</span>
												</span>
											</span>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" style="display:none;" id="c13973_list">
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516466500-f4ca95b40ad032a33a1e2090275b579d2d43a735">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>