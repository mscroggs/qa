<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>What options are available in FEniCS for solving stiff/non-stiff time-dependent problems? Can I use Method of Lines? - FEniCS Q&amp;A</title>
		<meta name="description" content="I am currently using my own finite volume code that discretises the advection ... ://www.scholarpedia.org/article/Backward_differentiation_formulas">
		<meta name="keywords" content="time-dependent,nonlinear,ode,mol">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/2788/options-available-fenics-solving-dependent-problems-method">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">What options are available in FEniCS for solving stiff/non-stiff time-dependent problems? Can I use Method of Lines?</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q2788">
								<form method="post" action="../../2788/options-available-fenics-solving-dependent-problems-method">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_2788">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+1<span class="votes-up"><span class="value-title" title="1"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516467944-c3b350dd67c86e5ae09d2de148efa0fbadb0bcb2">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../2788/options-available-fenics-solving-dependent-problems-method">
										<div class="qa-q-view-content">
											<a name="2788"></a><div class="entry-content"><p>I am currently using my own finite volume code that discretises the advection-diffusion-reaction equation. I only discretise the spatial operators this gives me a system of ODEs which can easily solved the tried and tested solvers (e.g. LSODE, Radau5  etc.). This approach is often called the <a rel="nofollow" href="http://www.scholarpedia.org/article/Method_of_lines">Method of Lines (MOL)</a>. This can be very useful as an adaptive ODE solver can be used which will automatically pick the most appropriate method (e.g. <a rel="nofollow" href="http://www.scholarpedia.org/article/Backward_differentiation_formulas">backwards differentiation formula</a> for stiff problems or Runge&#8211;Kutta for non-stiff).</p>

<p>I'm interested in exploring FEniCS and was wondering what options are available for time integration for stiff and non-stiff problems? Is a MOL scheme possible? Basically, how would somebody approach this problem using FEniCS?</p>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/time-dependent" rel="tag" class="qa-tag-link">time-dependent</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/nonlinear" rel="tag" class="qa-tag-link">nonlinear</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/ode" rel="tag" class="qa-tag-link">ode</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/mol" rel="tag" class="qa-tag-link">mol</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-avatar">
												<a href="../../user/boyfarrell" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/d0bbd5d01fb8044a8782d537c9b3734c?s=50" width="50" height="50" class="qa-avatar-image" alt=""></a>
											</span>
											<span class="qa-q-view-meta">
												<a href="../../2788/options-available-fenics-solving-dependent-problems-method" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2014-02-21T03:04:39+0000"></span>Feb 21, 2014</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/boyfarrell" class="qa-user-link url nickname">boyfarrell</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">360</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
												<br>
												<span class="qa-q-view-what">edited</span>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="updated"><span class="value-title" title="2014-02-21T05:38:21+0000"></span>Feb 21, 2014</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span><span class="qa-q-view-who-data"><a href="../../user/boyfarrell" class="qa-user-link url nickname">boyfarrell</a></span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c2788_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516467944-17ae447bf278a7b51ec7b8bf27c37373d8611905">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer answer-selected qa-a-list-item-selected" id="a2790">
									<form method="post" action="../../2788/options-available-fenics-solving-dependent-problems-method">
										<div class="qa-voting qa-voting-net" id="voting_2790">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+4<span class="votes-up"><span class="value-title" title="4"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516467944-c3b350dd67c86e5ae09d2de148efa0fbadb0bcb2">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../2788/options-available-fenics-solving-dependent-problems-method">
											<div class="qa-a-item-selected">
												<div class="qa-a-selection">
													<div class="qa-a-selected">&#160;</div>
													<div class="qa-a-selected-text">Best answer</div>
												</div>
												<div class="qa-a-item-content">
													<a name="2790"></a><div class="entry-content"><p>FEniCS does not have built-in methods for time integration. </p>

<p>The native way, that is also advocated in the <a rel="nofollow" href="http://fenicsproject.org/documentation/tutorial/timedep.html">tutorials on time-dependent problems</a>, is to discretize in time first, and then solve a sequence of stationary problems. This is often referred to as <em>Rothe's method</em> or <em>horizontal MOL</em>, cf. <a rel="nofollow" href="http://scicomp.stackexchange.com/questions/2962/pde-discretization-with-the-method-of-rothe-and-the-method-of-lines-modular-imp">this scicomp.SE question</a>.</p>

<p>Personally, I use to export the coefficient matrices to scipy arrays and so that I can apply any time integrator. See this code here for <a rel="nofollow" href="https://github.com/highlando/dolfin_navier_scipy/blob/master/dolfin_to_sparrays.py">Navier-Stokes problems</a>. This approach requires some programming for the treatment of nonlinearities and the boundary conditions.</p>

<p>Also, one probably can apply space-time variational formulations directly in FEniCS. But I don't have any experience with that.</p>
</div>
												</div>
												<span class="qa-a-item-avatar-meta">
													<span class="qa-a-item-avatar">
														<a href="../../user/Jan" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/c71e1343e533ab01bcce8649718574fa?s=40" width="40" height="40" class="qa-avatar-image" alt=""></a>
													</span>
													<span class="qa-a-item-meta">
														<a href="../../2788/options-available-fenics-solving-dependent-problems-method?show=2790#a2790" class="qa-a-item-what">answered</a>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2014-02-21T08:54:19+0000"></span>Feb 21, 2014</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span>
															<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/Jan" class="qa-user-link url nickname">Jan</a></span></span>
															<span class="qa-a-item-who-title">FEniCS User</span>
															<span class="qa-a-item-who-points">
																<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">8,290</span><span class="qa-a-item-who-points-pad"> points)</span>
															</span>
														</span>
														<br>
														<span class="qa-a-item-what">selected</span>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="updated"><span class="value-title" title="2014-02-21T09:23:29+0000"></span>Feb 21, 2014</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span><span class="qa-a-item-who-data"><a href="../../user/boyfarrell" class="qa-user-link url nickname">boyfarrell</a></span>
														</span>
													</span>
												</span>
											</div>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c2790_list">
												<div class="qa-c-list-item  hentry comment" id="c2791">
													<div class="qa-c-item-content">
														<a name="2791"></a><div class="entry-content"><p>Fancy seeing you here! </p>

<p>That's very helpful thanks. The scipy approach, if I understood correctly, would mean writing only the rhs of the equation in weak form (leaving the lhs time derivative continuous) and using FEniCS to provide the spatial discretisation of the rhs which is fed into scipy i the form of arrays and matrices?</p>

<p>For non-stiff problems the native method of time-stepping should work OK. But my concern is that for stiff problems BDFs are needed, it seem like I would have to implement this manually. The Rothe's approach (horizontal MOL) seems to apply the theta-method in time, and solve the system of equation for the next time step.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-avatar">
																<a href="../../user/boyfarrell" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/d0bbd5d01fb8044a8782d537c9b3734c?s=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
															</span>
															<span class="qa-c-item-meta">
																<a href="../../2788/options-available-fenics-solving-dependent-problems-method?show=2791#c2791" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-02-21T09:22:42+0000"></span>Feb 21, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/boyfarrell" class="qa-user-link url nickname">boyfarrell</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">360</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
																<br>
																<span class="qa-c-item-what">edited</span>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="updated"><span class="value-title" title="2014-02-21T09:34:24+0000"></span>Feb 21, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span><span class="qa-c-item-who-data"><a href="../../user/boyfarrell" class="qa-user-link url nickname">boyfarrell</a></span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c2792">
													<div class="qa-c-item-content">
														<a name="2792"></a><div class="entry-content"><p>Not, sure if I understood you correctly. In the 'scipy' approach also the time derivative is discretized in space by FE. In particular you will get a mass matrix in front of it. </p>

<p>Then, the mass matrix and the other discretized operators are exported so that one can solve <br>
$$<br>
M\dot v = Av + K(v) + f<br>
$$<br>
The export of a nonlinear relation can be done either as function, that returns the evaluation of $K(v)$ using FEniCS or as a matrix for a certain linearization. Also, time dependent coefficients cannot be readily exported but as a 'wrapper' that exports at specified time instances.</p>

<p>Finally, with Rothe's method you can apply any time integration scheme. And the nonlinear solvers in FEniCS, in particular, allow for implicit methods.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-avatar">
																<a href="../../user/Jan" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/c71e1343e533ab01bcce8649718574fa?s=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
															</span>
															<span class="qa-c-item-meta">
																<a href="../../2788/options-available-fenics-solving-dependent-problems-method?show=2792#c2792" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-02-21T09:42:45+0000"></span>Feb 21, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Jan" class="qa-user-link url nickname">Jan</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">8,290</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c2797">
													<div class="qa-c-item-content">
														<a name="2797"></a><div class="entry-content"><p>btw. nice to see you here. :)</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-avatar">
																<a href="../../user/Jan" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/c71e1343e533ab01bcce8649718574fa?s=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
															</span>
															<span class="qa-c-item-meta">
																<a href="../../2788/options-available-fenics-solving-dependent-problems-method?show=2797#c2797" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-02-21T13:42:05+0000"></span>Feb 21, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Jan" class="qa-user-link url nickname">Jan</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">8,290</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516467944-75b2669f380f40257674e187f836da3530617fa1">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>