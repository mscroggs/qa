<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>Can Fenics also implement a more general Robin boundary condition? - FEniCS Q&amp;A</title>
		<meta name="description" content="Dear All I have today implemented the Robin boundary condition where the normal derivative of u and ... V on the boundary of the domain regards Moritz">
		<meta name="keywords" content="boundary-conditions,fenics">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/343/fenics-also-implement-more-general-robin-boundary-condition">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">Can Fenics also implement a more general Robin boundary condition?</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q343">
								<form method="post" action="../../343/fenics-also-implement-more-general-robin-boundary-condition">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_343">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+4<span class="votes-up"><span class="value-title" title="4"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516467970-0fbb8c86d21b593adbeffc8ece5488798660abfb">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../343/fenics-also-implement-more-general-robin-boundary-condition">
										<div class="qa-q-view-content">
											<a name="343"></a><div class="entry-content"><p>Dear All</p>

<p>I have today implemented the Robin boundary condition where<br>
the normal derivative of  u and u are related by a constant.<br>
For my research I would be interested  in the case where<br>
the relation is a more general one such that <br>
du/dn(x)= \int K(x,y)  u(y)  ds <br>
which would correspond to a matrix relationship <br>
du/dn = L  u in the functionspace V on the boundary of the domain</p>

<p>regards</p>

<p>Moritz </p>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/boundary-conditions" rel="tag" class="qa-tag-link">boundary-conditions</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/fenics" rel="tag" class="qa-tag-link">fenics</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../343/fenics-also-implement-more-general-robin-boundary-condition" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2013-06-29T16:29:49+0000"></span>Jun 29, 2013</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/moritzbraun" class="qa-user-link url nickname">moritzbraun</a></span></span>
													<span class="qa-q-view-who-title">FEniCS User</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">1,390</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c343_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516467970-a8a5046af822c0a2aa0ffe15b703e902e24aa330">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer" id="a351">
									<form method="post" action="../../343/fenics-also-implement-more-general-robin-boundary-condition">
										<div class="qa-voting qa-voting-net" id="voting_351">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+2<span class="votes-up"><span class="value-title" title="2"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516467970-0fbb8c86d21b593adbeffc8ece5488798660abfb">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../343/fenics-also-implement-more-general-robin-boundary-condition">
											<div class="qa-a-selection">
											</div>
											<div class="qa-a-item-content">
												<a name="351"></a><div class="entry-content"><p>I'm afraid that discretization of such a non-local operator <br>
$$<br>
u \rightarrow \int K(x,y) u(y) \;\mathrm{d}S<br>
$$<br>
is not feasible to be done automatically by FEniCS. This is because you need to integrate again the term $\mathrm{d}u/\mathrm{d}\mathbf{n}$ so you end up with double integral. This is not supported. You can make a better picture from previous questions:</p>

<ul>
<li><a rel="nofollow" href="http://fenicsproject.org/qa/198/mapping-between-spaces-variable-transformation-functions">http://fenicsproject.org/qa/198/mapping-between-spaces-variable-transformation-functions</a></li>
<li><a rel="nofollow" href="http://scicomp.stackexchange.com/questions/7715/subdomain-integrals-in-fenics">http://scicomp.stackexchange.com/questions/7715/subdomain-integrals-in-fenics</a></li>
<li>some were also on <a rel="nofollow" href="https://answers.launchpad.net/fenics">https://answers.launchpad.net/fenics</a></li>
</ul>

<p>But you could succeed doing this in an iterative manner. For known $u$ you compute $\int K(x,y) u(y) \;\mathrm{d}S$ which can be certainly done with variational formulation. Then you use this quantity in BC of your original problem. You repeat these steps and hope it converges. You could probably write a custom Newton algorithm for this using automatic differentiation of FEniCS to improve convergence rate.</p>
</div>
											</div>
											<span class="qa-a-item-avatar-meta">
												<span class="qa-a-item-avatar">
													<a href="../../user/Jan+Blechta" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/dc6f8dce77e4a0bd5adc7ff31ab83741?s=40" width="40" height="40" class="qa-avatar-image" alt=""></a>
												</span>
												<span class="qa-a-item-meta">
													<a href="../../343/fenics-also-implement-more-general-robin-boundary-condition?show=351#a351" class="qa-a-item-what">answered</a>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2013-06-30T15:53:30+0000"></span>Jun 30, 2013</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span>
														<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/Jan+Blechta" class="qa-user-link url nickname">Jan Blechta</a></span></span>
														<span class="qa-a-item-who-title">FEniCS Expert</span>
														<span class="qa-a-item-who-points">
															<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">51,420</span><span class="qa-a-item-who-points-pad"> points)</span>
														</span>
													</span>
												</span>
											</span>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c351_list">
												<div class="qa-c-list-item  hentry comment" id="c602">
													<div class="qa-c-item-content">
														<a name="602"></a><div class="entry-content"><p>Dear Jan</p>

<p>I have again thought about the robin boundary condition and<br>
I realized, that my kernel is actually of the form<br>
   K(x,y)=\sum_{li} Y_{lm}(x) u_{lm} Y_{lm|^*(y)<br>
(sorry; don't know how have this type set in the preview)<br>
Thus instead of a double integral we are dealing with two integrations.<br>
and the corresponding matrix is a full matrix on the surface that however<br>
can be written as a sum of outer products.<br>
Is there a straightforward  way to implement the robin condition in fenics in this case?</p>

<p>regards</p>

<p>Moritz  </p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../343/fenics-also-implement-more-general-robin-boundary-condition?show=602#c602" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2013-07-16T17:50:15+0000"></span>Jul 16, 2013</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/moritzbraun" class="qa-user-link url nickname">moritzbraun</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">1,390</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c603">
													<div class="qa-c-item-content">
														<a name="603"></a><div class="entry-content"><blockquote>
  <p>$K(x,y)=\sum_{li} Y_{lm}(x) u_{lm} Y_{lm}^*(y)$</p>
</blockquote>

<p>Sorry, I don't understand your formula - what are correct indices there?</p>

<blockquote>
  <p>Is there a straightforward way to implement the robin condition in fenics in this case?</p>
</blockquote>

<p>You will have to be more concrete. Bring us some math exploiting your formula for $K(x,y)$.</p>

<p>Please, <a rel="nofollow" href="http://fenicsproject.org/qa/49/how-does-one-use-mathjax-in-the-fenics-q%26a-forum">use LaTeX</a>.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-avatar">
																<a href="../../user/Jan+Blechta" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/dc6f8dce77e4a0bd5adc7ff31ab83741?s=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
															</span>
															<span class="qa-c-item-meta">
																<a href="../../343/fenics-also-implement-more-general-robin-boundary-condition?show=603#c603" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2013-07-16T19:57:06+0000"></span>Jul 16, 2013</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Jan+Blechta" class="qa-user-link url nickname">Jan Blechta</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Expert</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">51,420</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516467970-37e23b13a262d40f0f5e69c8296d12e97adc37f4">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>