<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>How to do mesh smoothing when creating a mesh by FEniCS - FEniCS Q&amp;A</title>
		<meta name="description" content='Dear all I find that sometimes the mesh generated by cgal in FEniCS is not very regular, i.e.,  ... domain, 5) plot(mesh2d, "2D mesh") interactive()'>
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/5685/how-to-do-mesh-smoothing-when-creating-a-mesh-by-fenics">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">How to do mesh smoothing when creating a mesh by FEniCS</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q5685">
								<form method="post" action="../../5685/how-to-do-mesh-smoothing-when-creating-a-mesh-by-fenics">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_5685">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+1<span class="votes-up"><span class="value-title" title="1"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516468038-1469235fb66a98538e84668b0f01ad5c0936481b">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../5685/how-to-do-mesh-smoothing-when-creating-a-mesh-by-fenics">
										<div class="qa-q-view-content">
											<a name="5685"></a><div class="entry-content"><p>Dear all</p>

<p>I find that sometimes the mesh generated by cgal in FEniCS is not very regular,<br>
i.e., some elements seem to too small or too large. So is there any command that<br>
can smooth internal vertices of mesh by local averaging. Please see the following<br>
simple code for example. I hope to make every element has the same size.</p>

<p>Any help is welcome. Thank you~</p>

<pre><code>from dolfin import *

domain = Rectangle(0., 0., 1., 1.) + Circle(0.5, 1, .5)
mesh2d = Mesh(domain, 5)
plot(mesh2d, "2D mesh")

interactive()
</code></pre>
</div>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-avatar">
												<a href="../../user/Huadong+Gao" class="qa-avatar-link"><img src="../../?qa=image&amp;qa_blobid=8978876460067519879&amp;qa_size=50" width="37" height="50" class="qa-avatar-image" alt=""></a>
											</span>
											<span class="qa-q-view-meta">
												<a href="../../5685/how-to-do-mesh-smoothing-when-creating-a-mesh-by-fenics" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2014-10-01T11:30:47+0000"></span>Oct 1, 2014</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/Huadong+Gao" class="qa-user-link url nickname">Huadong Gao</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">230</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
												<br>
												<span class="qa-q-view-what">edited</span>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="updated"><span class="value-title" title="2014-10-01T15:22:09+0000"></span>Oct 1, 2014</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span><span class="qa-q-view-who-data"><a href="../../user/johannr" class="qa-user-link url nickname">johannr</a></span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" id="c5685_list">
											<div class="qa-c-list-item  hentry comment" id="c5702">
												<div class="qa-c-item-content">
													<a name="5702"></a><div class="entry-content"><p>Did you encounter any particular problems? The element size may be related to the boundary curvature etc. to ensure a good geometric representation of your actual domain. So what is wrong with the generated meshes? Of course you can always optimize your mesh afterwards, but the question which mesh is 'optimal' typically depends on your type of problem.</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../5685/how-to-do-mesh-smoothing-when-creating-a-mesh-by-fenics?show=5702#c5702" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-10-02T22:42:45+0000"></span>Oct 3, 2014</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Christian+Waluga" class="qa-user-link url nickname">Christian Waluga</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Expert</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">12,310</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c5703">
												<div class="qa-c-item-content">
													<a name="5703"></a><div class="entry-content"><p>Dear Christian Waluga</p>

<p>Thank you very much for your help. You are right. I just want to<br>
make the mesh smoother, i.e., every triangle has the same size.  <br>
Is there any built-in FEniCS command for mesh smoothing?</p>

<p>Thank you again~</p>

<p>Huadong</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-avatar">
															<a href="../../user/Huadong+Gao" class="qa-avatar-link"><img src="../../?qa=image&amp;qa_blobid=8978876460067519879&amp;qa_size=20" width="15" height="20" class="qa-avatar-image" alt=""></a>
														</span>
														<span class="qa-c-item-meta">
															<a href="../../5685/how-to-do-mesh-smoothing-when-creating-a-mesh-by-fenics?show=5703#c5703" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-10-03T04:35:23+0000"></span>Oct 3, 2014</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Huadong+Gao" class="qa-user-link url nickname">Huadong Gao</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Novice</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">230</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516468038-801eb2a9e1ef0d9077673b60f32008c269db1e38">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer answer-selected qa-a-list-item-selected" id="a5712">
									<form method="post" action="../../5685/how-to-do-mesh-smoothing-when-creating-a-mesh-by-fenics">
										<div class="qa-voting qa-voting-net" id="voting_5712">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+1<span class="votes-up"><span class="value-title" title="1"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516468038-1469235fb66a98538e84668b0f01ad5c0936481b">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../5685/how-to-do-mesh-smoothing-when-creating-a-mesh-by-fenics">
											<div class="qa-a-item-selected">
												<div class="qa-a-selection">
													<div class="qa-a-selected">&#160;</div>
													<div class="qa-a-selected-text">Best answer</div>
												</div>
												<div class="qa-a-item-content">
													<a name="5712"></a><div class="entry-content"><p>Hi, smoothing by local averaging is done by the <a rel="nofollow" href="https://bitbucket.org/fenics-project/dolfin/src/master/dolfin/mesh/Mesh.h?at=master#cl-479">smooth</a> method </p>

<pre><code>from dolfin import *

domain = Rectangle(0., 0., 1., 1.) + Circle(0.5, 1, .5)
mesh2d = Mesh(domain, 5)

plot(mesh2d, title="before smooth", interactive=True)
mesh2d.smooth(20)
plot(mesh2d, title="after smooth", interactive=True)
</code></pre>
</div>
												</div>
												<span class="qa-a-item-avatar-meta">
													<span class="qa-a-item-avatar">
														<a href="../../user/MiroK" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/f566be3274ec73e3a6dda27bca11631c?s=40" width="40" height="40" class="qa-avatar-image" alt=""></a>
													</span>
													<span class="qa-a-item-meta">
														<a href="../../5685/how-to-do-mesh-smoothing-when-creating-a-mesh-by-fenics?show=5712#a5712" class="qa-a-item-what">answered</a>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2014-10-04T17:34:12+0000"></span>Oct 4, 2014</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span>
															<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/MiroK" class="qa-user-link url nickname">MiroK</a></span></span>
															<span class="qa-a-item-who-title">FEniCS Expert</span>
															<span class="qa-a-item-who-points">
																<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">80,920</span><span class="qa-a-item-who-points-pad"> points)</span>
															</span>
														</span>
														<br>
														<span class="qa-a-item-what">selected</span>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="updated"><span class="value-title" title="2014-10-11T03:11:18+0000"></span>Oct 11, 2014</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span><span class="qa-a-item-who-data"><a href="../../user/Huadong+Gao" class="qa-user-link url nickname">Huadong Gao</a></span>
														</span>
													</span>
												</span>
											</div>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c5712_list">
												<div class="qa-c-list-item  hentry comment" id="c5713">
													<div class="qa-c-item-content">
														<a name="5713"></a><div class="entry-content"><p>MiroK, Thank you very much~ </p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-avatar">
																<a href="../../user/Huadong+Gao" class="qa-avatar-link"><img src="../../?qa=image&amp;qa_blobid=8978876460067519879&amp;qa_size=20" width="15" height="20" class="qa-avatar-image" alt=""></a>
															</span>
															<span class="qa-c-item-meta">
																<a href="../../5685/how-to-do-mesh-smoothing-when-creating-a-mesh-by-fenics?show=5713#c5713" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-10-05T04:37:33+0000"></span>Oct 5, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Huadong+Gao" class="qa-user-link url nickname">Huadong Gao</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">230</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516468038-2370e521e2d9091790ca3cc92c4ecb6c7be9ac66">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>