<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>System of equations with complex coefficients in UFL file - FEniCS Q&amp;A</title>
		<meta name="description" content="Hi everyone, I have to write the UFL form of an homogeneous system of four eqautions conatining  ...  for the imaginary part? Thanks for any answer">
		<meta name="keywords" content="ufl,complex,system,imaginary">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/8568/system-of-equations-with-complex-coefficients-in-ufl-file">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">System of equations with complex coefficients in UFL file</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q8568">
								<form method="post" action="../../8568/system-of-equations-with-complex-coefficients-in-ufl-file">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_8568">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516468180-d14e1e35bf1942fb67a4b64c77092cc6f9dd2e40">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../8568/system-of-equations-with-complex-coefficients-in-ufl-file">
										<div class="qa-q-view-content">
											<a name="8568"></a><div class="entry-content"><p>Hi everyone,</p>

<p>I have to write the UFL form of an homogeneous system of four eqautions conatining complex coeffcients, in particular one term of each equation has the imaginary unit in it. So far I have written one bilinear form which is the sum of the four equations with four scalar trial functions and four test functions.</p>

<p>How can I deal with this problem? Should I split the form in two parts, real and imanginary, defining another four trial functions for the imaginary part?</p>

<p>Thanks for any answer</p>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/ufl" rel="tag" class="qa-tag-link">ufl</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/complex" rel="tag" class="qa-tag-link">complex</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/system" rel="tag" class="qa-tag-link">system</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/imaginary" rel="tag" class="qa-tag-link">imaginary</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../8568/system-of-equations-with-complex-coefficients-in-ufl-file" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2015-11-16T09:10:23+0000"></span>Nov 16, 2015</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/ededonati" class="qa-user-link url nickname">ededonati</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">200</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c8568_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516468180-69421386035686175bb1e3fcc8092fe733891a39">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer" id="a8570">
									<form method="post" action="../../8568/system-of-equations-with-complex-coefficients-in-ufl-file">
										<div class="qa-voting qa-voting-net" id="voting_8570">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+1<span class="votes-up"><span class="value-title" title="1"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516468180-d14e1e35bf1942fb67a4b64c77092cc6f9dd2e40">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../8568/system-of-equations-with-complex-coefficients-in-ufl-file">
											<div class="qa-a-selection">
											</div>
											<div class="qa-a-item-content">
												<a name="8570"></a><div class="entry-content"><p>UFL has no support for complex numbers, so you can do it, as you say, by writing separate equations for the real and imaginary parts. It is also possible to use a <code>VectorFunctionSpace</code> by carefully writing the equations for each component.</p>

<p>In the future, complex numbers may be supported, but it requires a significant change to the entire codebase.</p>
</div>
											</div>
											<span class="qa-a-item-avatar-meta">
												<span class="qa-a-item-avatar">
													<a href="../../user/chris_richardson" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/d779daeb727bcec8f6b2c505810042db?s=40" width="40" height="40" class="qa-avatar-image" alt=""></a>
												</span>
												<span class="qa-a-item-meta">
													<a href="../../8568/system-of-equations-with-complex-coefficients-in-ufl-file?show=8570#a8570" class="qa-a-item-what">answered</a>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2015-11-16T10:20:28+0000"></span>Nov 16, 2015</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span>
														<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/chris_richardson" class="qa-user-link url nickname">chris_richardson</a></span></span>
														<span class="qa-a-item-who-title">FEniCS Expert</span>
														<span class="qa-a-item-who-points">
															<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">31,740</span><span class="qa-a-item-who-points-pad"> points)</span>
														</span>
													</span>
												</span>
											</span>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" style="display:none;" id="c8570_list">
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516468180-2159d41a9c35cb1b85e5a3df10ccc2799f80e856">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>