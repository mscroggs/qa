<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>Extracting Subdomains from XML File Converted from GMSH - FEniCS Q&amp;A</title>
		<meta name="description" content="Hi, I have generated a 3d mesh from GMSH and converted it to XML. I wish to implement simple Dirichlet ...  of the cube Physical Volume(34) = {1};">
		<meta name="keywords" content="gmsh,boundary-markers">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/3131/extracting-subdomains-from-xml-file-converted-from-gmsh">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">Extracting Subdomains from XML File Converted from GMSH</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q3131">
								<form method="post" action="../../3131/extracting-subdomains-from-xml-file-converted-from-gmsh">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_3131">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+3<span class="votes-up"><span class="value-title" title="3"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516467958-88bd68ed916be928cc1e100893e5e73f6839aa73">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../3131/extracting-subdomains-from-xml-file-converted-from-gmsh">
										<div class="qa-q-view-content">
											<a name="3131"></a><div class="entry-content"><p>Hi,</p>

<p>I have generated a 3d mesh from GMSH and converted it to XML.  I wish to implement simple Dirichlet boundary conditions on the borders of the mesh (and one internal surface).  Dolfin, however, does not recognise any labels inherited from GMSH, as I get the following error:</p>

<p>*** Warning: Found no facets matching domain for boundary condition.</p>

<p>I have found a similar question on the forums ( <a rel="nofollow" href="http://fenicsproject.org/qa/2986/how-to-define-boundary-condition-for-mesh-generated-by-gmsh">http://fenicsproject.org/qa/2986/how-to-define-boundary-condition-for-mesh-generated-by-gmsh</a> ) but I must admit I don't fully understand the solution.</p>

<p>Below, I have prepared a very simple .geo file that constructs a cube and labels the 6 surfaces and volume.  Would anyone be able to show me the modifications I would need to make to this .geo file so that dolfin can see the subdomains?</p>

<p>Thanks </p>

<p>P.S. Is the problem simplified if I export gmsh files in the medit format and then convert to XML?</p>

<pre><code>//Construct a cube in GMSH

//Build a line
Point(1) = {0, 0, 0, 1.0};
Point(2) = {0, 0, 10, 1.0};
Line(1) = {1, 2};

//Extrude line to create a surface (square)
Extrude {10, 0, 0} {
  Line{1};
}

//Extrude surface to create a volume (cube)
Extrude {0, 10, 0} {
  Surface{5};
}

//Six surfaces of the cube
Physical Surface(28) = {18};
Physical Surface(29) = {26};
Physical Surface(30) = {22}; 
Physical Surface(31) = {14};
Physical Surface(32) = {27};
Physical Surface(33) = {5};

//Volume of the cube
Physical Volume(34) = {1};
</code></pre>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/gmsh" rel="tag" class="qa-tag-link">gmsh</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/boundary-markers" rel="tag" class="qa-tag-link">boundary-markers</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../3131/extracting-subdomains-from-xml-file-converted-from-gmsh" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2014-03-30T03:31:33+0000"></span>Mar 30, 2014</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/sixtysymbols" class="qa-user-link url nickname">sixtysymbols</a></span></span>
													<span class="qa-q-view-who-title">FEniCS User</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">2,280</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
												<br>
												<span class="qa-q-view-what">retagged</span>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="updated"><span class="value-title" title="2014-03-30T04:47:26+0000"></span>Mar 30, 2014</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span><span class="qa-q-view-who-data"><a href="../../user/sixtysymbols" class="qa-user-link url nickname">sixtysymbols</a></span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c3131_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516467958-b9f1339ddc22ac6002377934b6bc7d18aa300fc6">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer answer-selected qa-a-list-item-selected" id="a3133">
									<form method="post" action="../../3131/extracting-subdomains-from-xml-file-converted-from-gmsh">
										<div class="qa-voting qa-voting-net" id="voting_3133">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+3<span class="votes-up"><span class="value-title" title="3"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516467958-88bd68ed916be928cc1e100893e5e73f6839aa73">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../3131/extracting-subdomains-from-xml-file-converted-from-gmsh">
											<div class="qa-a-item-selected">
												<div class="qa-a-selection">
													<div class="qa-a-selected">&#160;</div>
													<div class="qa-a-selected-text">Best answer</div>
												</div>
												<div class="qa-a-item-content">
													<a name="3133"></a><div class="entry-content"><p>Hi,</p>

<p>try it like this:</p>

<pre><code>//Six surfaces of the cube
Physical Surface(0) = {18};
Physical Surface(1) = {26};
Physical Surface(2) = {22}; 
Physical Surface(3) = {14};
Physical Surface(4) = {27};
Physical Surface(5) = {5};

//Volume of the cube
Physical Volume(0) = {1};
</code></pre>

<p>You could also find more detail explanation on the link you have posted above (in comments section):<br>
<a rel="nofollow" href="http://fenicsproject.org/qa/2986/how-to-define-boundary-condition-for-mesh-generated-by-gmsh">http://fenicsproject.org/qa/2986/how-to-define-boundary-condition-for-mesh-generated-by-gmsh</a></p>

<p>Try it and say if it works or not:)</p>

<p>Regards, Maksim</p>
</div>
												</div>
												<span class="qa-a-item-avatar-meta">
													<span class="qa-a-item-meta">
														<a href="../../3131/extracting-subdomains-from-xml-file-converted-from-gmsh?show=3133#a3133" class="qa-a-item-what">answered</a>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2014-03-30T06:50:41+0000"></span>Mar 30, 2014</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span>
															<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/Maks" class="qa-user-link url nickname">Maks</a></span></span>
															<span class="qa-a-item-who-title">FEniCS User</span>
															<span class="qa-a-item-who-points">
																<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">2,430</span><span class="qa-a-item-who-points-pad"> points)</span>
															</span>
														</span>
														<br>
														<span class="qa-a-item-what">selected</span>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="updated"><span class="value-title" title="2014-03-30T16:38:29+0000"></span>Mar 30, 2014</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span><span class="qa-a-item-who-data"><a href="../../user/sixtysymbols" class="qa-user-link url nickname">sixtysymbols</a></span>
														</span>
													</span>
												</span>
											</div>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c3133_list">
												<div class="qa-c-list-item  hentry comment" id="c3135">
													<div class="qa-c-item-content">
														<a name="3135"></a><div class="entry-content"><p>Hi</p>

<p>This procures solved the problem I was having for my original, complicated mesh.</p>

<p>It also solved the problem with the cube example above but, additionally, I had not noticed that dolfin-convert had produced a _physical_region.xml and _facet_region.xml for the cube.msh even before I had made the changes above (Though this was not the case for my more complicated mesh).</p>

<p>Boundary conditions were recognised without problem after that.</p>

<p>Thanks,</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../3131/extracting-subdomains-from-xml-file-converted-from-gmsh?show=3135#c3135" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-03-30T16:44:09+0000"></span>Mar 30, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/sixtysymbols" class="qa-user-link url nickname">sixtysymbols</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">2,280</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c3144">
													<div class="qa-c-item-content">
														<a name="3144"></a><div class="entry-content"><p>Actually, a quick update.</p>

<p>I found that I had to start the labeling at 1 as opposed to 0.  I.e.</p>

<pre><code>//Six surfaces of the cube
Physical Surface(1) = {18};
Physical Surface(2) = {26};
Physical Surface(3) = {22}; 
Physical Surface(4) = {14};
Physical Surface(5) = {27};
Physical Surface(6) = {5};

//Volume of the cube
Physical Volume(1) = {1};
</code></pre>

<p>If I started at 0, no error was reported, but it would confuse the physical volume with the first surface boundary and misapply the Dirichlet boundary conditions.  It might have something to do with 0 being reserved as a default for all boundaries and subdomains.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../3131/extracting-subdomains-from-xml-file-converted-from-gmsh?show=3144#c3144" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-04-01T00:20:57+0000"></span>Apr 1, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/sixtysymbols" class="qa-user-link url nickname">sixtysymbols</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">2,280</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c3296">
													<div class="qa-c-item-content">
														<a name="3296"></a><div class="entry-content"><blockquote>
  <p>I found that I had to start the labeling at 1 as opposed to 0.</p>
</blockquote>

<p>Yes, you are right.<br>
I have checked it and got the same result.<br>
Thank you!</p>

<p>We have to manually renumber Physical Surface and Physical Volume from 1, like you did here, otherwise we get wrong boundary conditions.</p>

<p>I use this "dolfin-convert" script file under Ubuntu OS to convert mesh from GMSH (.msh) to Fenics dolfin format (.xml):<br>
<a rel="nofollow" href="https://github.com/FEniCS/dolfin/blob/master/scripts/dolfin-convert/dolfin-convert">https://github.com/FEniCS/dolfin/blob/master/scripts/dolfin-convert/dolfin-convert</a></p>

<p>Also I can't convert mesh is generated by GMSH under Windows OS to Fenics dolfin under Ubuntu OS, because it ("dolfin-convert" script) throws an error, so I have to generate mesh in GMSH under Ubuntu OS.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../3131/extracting-subdomains-from-xml-file-converted-from-gmsh?show=3296#c3296" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-04-15T10:01:39+0000"></span>Apr 15, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Maks" class="qa-user-link url nickname">Maks</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">2,430</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516467958-79092bda12245256cadb6f69b930e1cbfe16719c">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>