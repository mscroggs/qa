<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>More complicated meshes - FEniCS Q&amp;A</title>
		<meta name="description" content="I was wondering how to build more complicated meshes, that can be broken down into elementary forms  ...  http://www.rp-photonics.com/img/pcf.png">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/6146/more-complicated-meshes">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">More complicated meshes</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q6146">
								<form method="post" action="../../6146/more-complicated-meshes">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_6146">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+1<span class="votes-up"><span class="value-title" title="1"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516468060-8bf68775c564c3a8db67424979dac520901b923b">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../6146/more-complicated-meshes">
										<div class="qa-q-view-content">
											<a name="6146"></a><div class="entry-content"><p>I was wondering how to build more complicated meshes, that can be broken down into elementary forms though. In my example I want to mesh a structure like so: </p>

<p><img src="http://www.rp-photonics.com/img/pcf.png" alt="enter image description here"></p>

<p>If it is possible with standard tools that would be great, but anyhow how are shapes like the dolfin from the FEniCS demos meshed?</p>

<p>Steffen</p>
</div>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../6146/more-complicated-meshes" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2014-12-05T14:13:08+0000"></span>Dec 5, 2014</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/Steffen+Wittek" class="qa-user-link url nickname">Steffen Wittek</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">210</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c6146_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516468060-721efe712b66de53957c9875ca5859555c40b38b">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer answer-selected qa-a-list-item-selected" id="a6147">
									<form method="post" action="../../6146/more-complicated-meshes">
										<div class="qa-voting qa-voting-net" id="voting_6147">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+3<span class="votes-up"><span class="value-title" title="3"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516468060-8bf68775c564c3a8db67424979dac520901b923b">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../6146/more-complicated-meshes">
											<div class="qa-a-item-selected">
												<div class="qa-a-selection">
													<div class="qa-a-selected">&#160;</div>
													<div class="qa-a-selected-text">Best answer</div>
												</div>
												<div class="qa-a-item-content">
													<a name="6147"></a><div class="entry-content"><p>Hei Steffen!</p>

<p>This could easily be done with f.ex. MSHR, the default meshing env. in FEniCS. Another option is to use gmsh to mesh everything, then convert it to .xml using dolfin-convert.</p>

<p>Using mshr:</p>

<pre><code>from dolfin import *
from mshr import *

# Create circles as Circle(Center, Radius)
circle1 = Circle(Point(0,0), 5)
circle2 = Circle(Point(-1,0), 0.2)
circle3 = Circle(Point(1,0), 0.2)
circle4 = Circle(Point(0,1), 0.2)
circle5 = Circle(Point(0,-1), 0.2)

domain = circle1 - circle2 - circle3 - circle4 - circle5
r = 150   # Resolution of mesh
mesh = generate_mesh(domain, r)

plot(mesh, interactive=True)
</code></pre>

<p><img src="http://s28.postimg.org/o5yjdbc8t/dolfin_plot_0.png" alt="enter image description here"></p>

<p>Should be quite straightforward to create your mesh! MSHR also has the possibility to control sizes of cells and so on, check its wiki and API here : <a rel="nofollow" href="https://bitbucket.org/benjamik/mshr/wiki/Home.">https://bitbucket.org/benjamik/mshr/wiki/Home.</a> There are a lot of possibilites!</p>

<p>Hope this helps!</p>
</div>
												</div>
												<span class="qa-a-item-avatar-meta">
													<span class="qa-a-item-meta">
														<a href="../../6146/more-complicated-meshes?show=6147#a6147" class="qa-a-item-what">answered</a>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2014-12-05T15:47:26+0000"></span>Dec 5, 2014</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span>
															<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/joakibo" class="qa-user-link url nickname">joakibo</a></span></span>
															<span class="qa-a-item-who-title">FEniCS User</span>
															<span class="qa-a-item-who-points">
																<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">1,140</span><span class="qa-a-item-who-points-pad"> points)</span>
															</span>
														</span>
														<br>
														<span class="qa-a-item-what">selected</span>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="updated"><span class="value-title" title="2014-12-05T18:12:26+0000"></span>Dec 5, 2014</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span><span class="qa-a-item-who-data"><a href="../../user/Steffen+Wittek" class="qa-user-link url nickname">Steffen Wittek</a></span>
														</span>
													</span>
												</span>
											</div>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c6147_list">
												<div class="qa-c-list-item  hentry comment" id="c6148">
													<div class="qa-c-item-content">
														<a name="6148"></a><div class="entry-content"><p>Hi Joakibo,</p>

<p>thank you very much for your reply. It definitely goes into the right direction, but is it possible to create a mesh that adapts the density? It doesn't make sense to have a very dense mesh in the outer perimeter while around the holes it definitely does. Furthermore the mesh has to be also inside the holes as I want to solve the Helmholtz Equations in the whole structure. An example for such an adaptive mesh would would be:</p>

<p><img src="http://ej.iop.org/images/0957-0233/24/9/094004/Full/mst458011f3_online.jpg" alt="enter image description here"></p>

<p>Note that they also do not mesh inside the holes. Can mshr also do that?</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../6146/more-complicated-meshes?show=6148#c6148" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-12-05T16:09:55+0000"></span>Dec 5, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Steffen+Wittek" class="qa-user-link url nickname">Steffen Wittek</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">210</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c6154">
													<div class="qa-c-item-content">
														<a name="6154"></a><div class="entry-content"><p>If you apply GMSH this could be done quite easy by manually controlling the resolution of the cells surrounding the boundary of the inner circles. I'm unsure about MSHR and how to specifically control resolution in 2D, someone with more knowledge should reply on that..</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../6146/more-complicated-meshes?show=6154#c6154" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-12-05T17:07:31+0000"></span>Dec 5, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/joakibo" class="qa-user-link url nickname">joakibo</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">1,140</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c6155">
													<div class="qa-c-item-content">
														<a name="6155"></a><div class="entry-content"><p>Perfect. I will use GMSH then first. Thank you a lot :). </p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../6146/more-complicated-meshes?show=6155#c6155" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-12-05T18:12:17+0000"></span>Dec 5, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Steffen+Wittek" class="qa-user-link url nickname">Steffen Wittek</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">210</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516468060-d348e737dcca47dd0685cecd6ae3f136871755ca">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>