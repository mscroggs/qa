<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>How to plot just the values in a SubDomain? - FEniCS Q&amp;A</title>
		<meta name="description" content="Hello, I'm working on a mixed problem in which the values of the variables are in different  ...  should be ploted. Thanks in advance, Best regards">
		<meta name="keywords" content="subdomain,plot">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/10038/how-to-plot-just-the-values-in-a-subdomain">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">How to plot just the values in a SubDomain?</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q10038">
								<form method="post" action="../../10038/how-to-plot-just-the-values-in-a-subdomain">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_10038">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516467037-816adb51f20dc2c71631ae1c8ad62fc90cd4c70a">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../10038/how-to-plot-just-the-values-in-a-subdomain">
										<div class="qa-q-view-content">
											<a name="10038"></a><div class="entry-content"><p>Hello,</p>

<p>I'm working on a mixed problem in which the values of the variables are in different order of magnitude for different subdomains so it is not possible to visualize the lower values with regular plot.</p>

<p>I would like to know if there is a easy way to plot just the values of a single subdomain. For example, if I can use SubDomain objects marked by CellFunction to select which points should be ploted.</p>

<p>Thanks in advance,<br>
Best regards</p>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/subdomain" rel="tag" class="qa-tag-link">subdomain</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/plot" rel="tag" class="qa-tag-link">plot</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../10038/how-to-plot-just-the-values-in-a-subdomain" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2016-05-08T13:48:34+0000"></span>May 8, 2016</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/EduardoMS" class="qa-user-link url nickname">EduardoMS</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">270</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c10038_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516467037-2fa6bd88a56709c683794bc4f0868f546a44d02f">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">2 Answers</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer answer-selected qa-a-list-item-selected" id="a10045">
									<form method="post" action="../../10038/how-to-plot-just-the-values-in-a-subdomain">
										<div class="qa-voting qa-voting-net" id="voting_10045">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+2<span class="votes-up"><span class="value-title" title="2"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516467037-816adb51f20dc2c71631ae1c8ad62fc90cd4c70a">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../10038/how-to-plot-just-the-values-in-a-subdomain">
											<div class="qa-a-item-selected">
												<div class="qa-a-selection">
													<div class="qa-a-selected">&#160;</div>
													<div class="qa-a-selected-text">Best answer</div>
												</div>
												<div class="qa-a-item-content">
													<a name="10045"></a><div class="entry-content"><p>Also you can "extract" your solution only at the dofs that belongs to a given cell. Something like this:</p>

<pre><code>from dolfin import *

mesh = UnitSquareMesh(100, 100, "crossed")
V = FunctionSpace(mesh, "CG", 2)
u = interpolate(Expression("x[0]*x[0] + x[1]*x[1]"), V)

class half(SubDomain):
  def inside(self, x, on_boundary):
    return x[0] &gt; 0.5

cell_f = CellFunction("size_t", mesh)
cell_f.set_all(0)
half = half()

# mark subdomains
for cell in cells(mesh):
  if half.inside(cell.midpoint(), True):
    cell_f[cell.index()] = 1

def extract_values(u, cell_function, subdomain_id, V):
  dofmap = V.dofmap()
  mesh = V.mesh()
  for cell in cells(mesh):
    # Preserve only the dofs in cells marked as subdomain_id
    if cell_function[cell.index()] != subdomain_id:
      dofs = dofmap.cell_dofs(cell.index())
      for dof in dofs:
        u.vector()[dof] = 0.0
  return u


u_left  = Function(V); u_left.vector()[:]  = u.vector()
u_right = Function(V); u_right.vector()[:] = u.vector()
u_left  = extract_values(u_left, cell_f, 0, V)
u_right = extract_values(u_right, cell_f, 1, V)

plot(u_left, title="left")
plot(u_right, title="right")
interactive()
</code></pre>
</div>
												</div>
												<span class="qa-a-item-avatar-meta">
													<span class="qa-a-item-avatar">
														<a href="../../user/hernan_mella" class="qa-avatar-link"><img src="../../?qa=image&amp;qa_blobid=14920815903966845416&amp;qa_size=40" width="40" height="22" class="qa-avatar-image" alt=""></a>
													</span>
													<span class="qa-a-item-meta">
														<a href="../../10038/how-to-plot-just-the-values-in-a-subdomain?show=10045#a10045" class="qa-a-item-what">answered</a>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2016-05-09T12:14:05+0000"></span>May 9, 2016</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span>
															<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/hernan_mella" class="qa-user-link url nickname">hernan_mella</a></span></span>
															<span class="qa-a-item-who-title">FEniCS Expert</span>
															<span class="qa-a-item-who-points">
																<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">19,460</span><span class="qa-a-item-who-points-pad"> points)</span>
															</span>
														</span>
														<br>
														<span class="qa-a-item-what">edited</span>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="updated"><span class="value-title" title="2016-05-10T15:34:39+0000"></span>May 10, 2016</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span><span class="qa-a-item-who-data"><a href="../../user/hernan_mella" class="qa-user-link url nickname">hernan_mella</a></span>
														</span>
													</span>
												</span>
											</div>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c10045_list">
												<div class="qa-c-list-item  hentry comment" id="c10064">
													<div class="qa-c-item-content">
														<a name="10064"></a><div class="entry-content"><p>Thank you! This really solved my problem.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../10038/how-to-plot-just-the-values-in-a-subdomain?show=10064#c10064" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2016-05-10T02:19:07+0000"></span>May 10, 2016</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/EduardoMS" class="qa-user-link url nickname">EduardoMS</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">270</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c11877">
													<div class="qa-c-item-content">
														<a name="11877"></a><div class="entry-content"><p>For those interested in extracting the solution on a set of nodes defined as a facet mesh function, see MiroK's answer (thanks again to him) to this question: <a rel="nofollow" href="https://fenicsproject.org/qa/11876/extract-solution-at-a-set-of-nodes.">https://fenicsproject.org/qa/11876/extract-solution-at-a-set-of-nodes.</a> Martin</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-avatar">
																<a href="../../user/Martin+Genet" class="qa-avatar-link"><img src="../../?qa=image&amp;qa_blobid=4996080535152988109&amp;qa_size=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
															</span>
															<span class="qa-c-item-meta">
																<a href="../../10038/how-to-plot-just-the-values-in-a-subdomain?show=11877#c11877" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2016-12-08T16:51:06+0000"></span>Dec 8, 2016</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Martin+Genet" class="qa-user-link url nickname">Martin Genet</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">1,460</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
																<br>
																<span class="qa-c-item-what">edited</span>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="updated"><span class="value-title" title="2016-12-10T14:38:20+0000"></span>Dec 10, 2016</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span><span class="qa-c-item-who-data"><a href="../../user/Martin+Genet" class="qa-user-link url nickname">Martin Genet</a></span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516467037-16b555989cc7a78e007030b1622992f490db5f01">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
								<div class="qa-a-list-item  hentry answer" id="a10041">
									<form method="post" action="../../10038/how-to-plot-just-the-values-in-a-subdomain">
										<div class="qa-voting qa-voting-net" id="voting_10041">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516467037-816adb51f20dc2c71631ae1c8ad62fc90cd4c70a">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../10038/how-to-plot-just-the-values-in-a-subdomain">
											<div class="qa-a-selection">
											</div>
											<div class="qa-a-item-content">
												<a name="10041"></a><div class="entry-content"><p>Unfortunately, this is not possible today. However, you can adjust the value range plotted like this:</p>

<pre><code>plot(u, range_min=0., range_max=1.)
</code></pre>
</div>
											</div>
											<span class="qa-a-item-avatar-meta">
												<span class="qa-a-item-meta">
													<a href="../../10038/how-to-plot-just-the-values-in-a-subdomain?show=10041#a10041" class="qa-a-item-what">answered</a>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2016-05-09T07:07:04+0000"></span>May 9, 2016</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span>
														<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/%C3%98yvind+Evju" class="qa-user-link url nickname">&#216;yvind Evju</a></span></span>
														<span class="qa-a-item-who-title">FEniCS Expert</span>
														<span class="qa-a-item-who-points">
															<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">17,700</span><span class="qa-a-item-who-points-pad"> points)</span>
														</span>
													</span>
												</span>
											</span>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c10041_list">
												<div class="qa-c-list-item  hentry comment" id="c10065">
													<div class="qa-c-item-content">
														<a name="10065"></a><div class="entry-content"><p>Thank you for attention! But this doesn't remove the undesired points. It just set the value of them to range_max when they are greater than range_max.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../10038/how-to-plot-just-the-values-in-a-subdomain?show=10065#c10065" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2016-05-10T02:20:46+0000"></span>May 10, 2016</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/EduardoMS" class="qa-user-link url nickname">EduardoMS</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">270</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516467037-a087aa2f2933c0247254ed4c74baca53d41529e7">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>