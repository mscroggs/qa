<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>Importing a mesh XML file seems to alter the order of the nodes in a triangle? - FEniCS Q&amp;A</title>
		<meta name="description" content="Ok - I have a semi-large XML file that I generate outside of FEniCS. The mesh file loads and plots  ...  X 10.7 snapshot from yesterday (17-Nov-2013).">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/1717/importing-mesh-file-seems-alter-the-order-the-nodes-triangle">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">Importing a mesh XML file seems to alter the order of the nodes in a triangle?</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q1717">
								<form method="post" action="../../1717/importing-mesh-file-seems-alter-the-order-the-nodes-triangle">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_1717">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+2<span class="votes-up"><span class="value-title" title="2"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516467897-80062ad5b919638cbb4f4de484765cb091a51a72">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../1717/importing-mesh-file-seems-alter-the-order-the-nodes-triangle">
										<div class="qa-q-view-content">
											<a name="1717"></a><div class="entry-content"><p>Ok - I have a semi-large XML file that I generate outside of FEniCS. The mesh file loads and plots without FEniCS complaining about it, and it does indeed look like I wanted it to look in the plot command. However, it appears that the order of the nodes gets altered during import. An example triangle tag in the file is:</p>

<pre><code>&lt;triangle index="46" v0="49" v1="43" v2="46" /&gt;
</code></pre>

<p>However, if inside of the script, I ask it for the nodes the make up cell 46, I get:</p>

<pre><code>mesh = Mesh("stuff.xml.gz")
mesh.cells()[46]
array([43, 46, 49], dtype=uint32)
</code></pre>

<p>I was wondering if there was some way to import the mesh without having anything done to the node ordering, since I have a couple of mesh function files that I am loading, and one of them depends on the order of the edges in the cells being left alone.</p>

<p>I am using the OS X 10.7 snapshot from yesterday (17-Nov-2013).</p>
</div>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../1717/importing-mesh-file-seems-alter-the-order-the-nodes-triangle" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2013-11-18T21:32:38+0000"></span>Nov 18, 2013</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/timm" class="qa-user-link url nickname">timm</a></span></span>
													<span class="qa-q-view-who-title">FEniCS User</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">2,100</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c1717_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516467897-0f95f3e5515083541f3ca388de13554e24073e78">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer answer-selected qa-a-list-item-selected" id="a1718">
									<form method="post" action="../../1717/importing-mesh-file-seems-alter-the-order-the-nodes-triangle">
										<div class="qa-voting qa-voting-net" id="voting_1718">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+3<span class="votes-up"><span class="value-title" title="3"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516467897-80062ad5b919638cbb4f4de484765cb091a51a72">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../1717/importing-mesh-file-seems-alter-the-order-the-nodes-triangle">
											<div class="qa-a-item-selected">
												<div class="qa-a-selection">
													<div class="qa-a-selected">&#160;</div>
													<div class="qa-a-selected-text">Best answer</div>
												</div>
												<div class="qa-a-item-content">
													<a name="1718"></a><div class="entry-content"><p>The <code>Mesh</code> should be ordered accordingly with the <code>UFC</code> numbering, which is in ascending order for it to comply with the <code>FEniCS</code> pipeline. If the <code>Mesh</code> is not ordered according to the <code>UFC</code> numbering it will be ordered during construction. I do not think you can avoid that.</p>

<p>I think the best you can do is to order the connectivity before you write it to file, and then sort your edge information accordingly. I think there are some external mesh formats in <code>meshconverter.py</code> that do that already.</p>
</div>
												</div>
												<span class="qa-a-item-avatar-meta">
													<span class="qa-a-item-avatar">
														<a href="../../user/johanhake" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/73612279d6702974866af2e1a9653a5b?s=40" width="40" height="40" class="qa-avatar-image" alt=""></a>
													</span>
													<span class="qa-a-item-meta">
														<a href="../../1717/importing-mesh-file-seems-alter-the-order-the-nodes-triangle?show=1718#a1718" class="qa-a-item-what">answered</a>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2013-11-19T07:23:51+0000"></span>Nov 19, 2013</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span>
															<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/johanhake" class="qa-user-link url nickname">johanhake</a></span></span>
															<span class="qa-a-item-who-title">FEniCS Expert</span>
															<span class="qa-a-item-who-points">
																<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">22,480</span><span class="qa-a-item-who-points-pad"> points)</span>
															</span>
														</span>
														<br>
														<span class="qa-a-item-what">selected</span>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="updated"><span class="value-title" title="2013-11-19T15:41:30+0000"></span>Nov 19, 2013</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span><span class="qa-a-item-who-data"><a href="../../user/timm" class="qa-user-link url nickname">timm</a></span>
														</span>
													</span>
												</span>
											</div>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c1718_list">
												<div class="qa-c-list-item  hentry comment" id="c1725">
													<div class="qa-c-item-content">
														<a name="1725"></a><div class="entry-content"><p>Ok - tried this in Exodus II:</p>

<pre><code>Converting from Exodus II format to NetCDF format
Traceback (most recent call last):
  File "/Applications/FEniCS.app/Contents/Resources/bin/dolfin-convert", line 131, in &lt;module&gt;
    main(sys.argv[1:])
  File "/Applications/FEniCS.app/Contents/Resources/bin/dolfin-convert", line 78, in main
    meshconvert.convert2xml(ifilename, ofilename, iformat=iformat)
  File "/Applications/FEniCS.app/Contents/Resources/lib/python2.7/site-packages/dolfin_utils/meshconvert/meshconvert.py", line 1291, in convert2xml
    convert(ifilename, XmlHandler(ofilename), iformat=iformat)
  File "/Applications/FEniCS.app/Contents/Resources/lib/python2.7/site-packages/dolfin_utils/meshconvert/meshconvert.py", line 1336, in convert
    exodus2xml(ifilename, ofilename)
  File "/Applications/FEniCS.app/Contents/Resources/lib/python2.7/site-packages/dolfin_utils/meshconvert/meshconvert.py", line 1277, in exodus2xml
    raise IOError, "Something wrong while executing ncdump. Is ncdump "\
IOError: Something wrong while executing ncdump. Is ncdump installed on the system?

tim@shiny:Stuff$ which ncdump
/Users/tim/bin/ncdump
</code></pre>

<p>Next - tried after running ncdump myself:</p>

<pre><code>tim@shiny:Stuff$ dolfin-convert test.ncdf test.xml
Converting from NetCDF format (.ncdf) to DOLFIN XML format
Expecting 16 cells
Traceback (most recent call last):
  File "/Applications/FEniCS.app/Contents/Resources/bin/dolfin-convert", line 131, in &lt;module&gt;
    main(sys.argv[1:])
  File "/Applications/FEniCS.app/Contents/Resources/bin/dolfin-convert", line 78, in main
    meshconvert.convert2xml(ifilename, ofilename, iformat=iformat)
  File "/Applications/FEniCS.app/Contents/Resources/lib/python2.7/site-packages/dolfin_utils/meshconvert/meshconvert.py", line 1291, in convert2xml
    convert(ifilename, XmlHandler(ofilename), iformat=iformat)
  File "/Applications/FEniCS.app/Contents/Resources/lib/python2.7/site-packages/dolfin_utils/meshconvert/meshconvert.py", line 1333, in convert
    netcdf2xml(ifilename, ofilename)
  File "/Applications/FEniCS.app/Contents/Resources/lib/python2.7/site-packages/dolfin_utils/meshconvert/meshconvert.py", line 1208, in netcdf2xml
    n0 = int(connect[0])-1
ValueError: invalid literal for int() with base 10: ''
</code></pre>

<p>I am running the snapshot from two days ago, and I'll see if I can figure out what it didn't like .</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../1717/importing-mesh-file-seems-alter-the-order-the-nodes-triangle?show=1725#c1725" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2013-11-19T16:11:47+0000"></span>Nov 19, 2013</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/timm" class="qa-user-link url nickname">timm</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">2,100</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c1729">
													<div class="qa-c-item-content">
														<a name="1729"></a><div class="entry-content"><p>Not sure what you want with your post. If you want me to help you you need to provide more information about what you did and the files you tried to convert.</p>

<p>Have in mind that <code>dolfin-convert</code> is a community driven script that unfortunately keeps breaking as the interface of <code>dolfin</code> keep changing. There are too few unit tests that covers that script. If you discovers a bug it is probably best to try to contact the author of the particular conversion that is broken or try fixing it your self.</p>

<p>Also I did not suggest you to use <code>dolfin-convert</code> directly. I meant to suggest you to take a look into how some of the backends, like gmsh I think, reorders the vertex information according to <code>UFC</code> ordering, while also updating facet information.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-avatar">
																<a href="../../user/johanhake" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/73612279d6702974866af2e1a9653a5b?s=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
															</span>
															<span class="qa-c-item-meta">
																<a href="../../1717/importing-mesh-file-seems-alter-the-order-the-nodes-triangle?show=1729#c1729" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2013-11-20T07:43:45+0000"></span>Nov 20, 2013</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/johanhake" class="qa-user-link url nickname">johanhake</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Expert</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">22,480</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516467897-79e6df51c6042d98fd27462750ad8a885f22f58b">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>