<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>Advection diffusion coefficient - FEniCS Q&amp;A</title>
		<meta name="description" content="Hi, I just found the [advection-diffusion example][1] on github and in the ... master/demo/undocumented/advection-diffusion/cpp/AdvectionDiffusion.ufl">
		<meta name="keywords" content="convection-diffusion,diffusion,coefficient,demo,ufl">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/10704/advection-diffusion-coefficient">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">Advection diffusion coefficient</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q10704">
								<form method="post" action="../../10704/advection-diffusion-coefficient">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_10704">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516467074-f51c3d1f7964be2c0c91a1bdf4add8e529d7108d">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../10704/advection-diffusion-coefficient">
										<div class="qa-q-view-content">
											<a name="10704"></a><div class="entry-content"><p>Hi,</p>

<p>I just found the <a rel="nofollow" href="https://github.com/FEniCS/dolfin/blob/master/demo/undocumented/advection-diffusion/cpp/AdvectionDiffusion.ufl">advection-diffusion example</a> on github and in the UFL-File</p>

<pre><code>u = TrialFunction(scalar)
v  = TestFunction(scalar)
u0 = Coefficient(scalar)
b  = Coefficient(vector)
f  = Coefficient(scalar)

c = 0.005
k = 0.05

a = u*v*dx + 0.5*k*(dot(b, grad(u)*v)*dx + c*dot(grad(u), grad(v))*dx)
L = u0*v*dx - 0.5*k*(dot(b, grad(u0)*v)*dx + c*dot( grad(u0), grad(v))*dx) \
    + k*f*v*dx
</code></pre>

<p>I don't understand what c and k should represent and why they are set as variable, but the other factors (0.5 in the equation of a and L) are not.<br>
Is there any difference?</p>

<p>I was wondering if they were something like the diffusion coefficient and if the diffusion coefficient could be set to an manually by Defining it with <code>D  = Coefficient(scalar)</code>?</p>

<p>I hope you have some Ideas, what I want to realize and how this could be done.</p>

<p>Thanks</p>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/convection-diffusion" rel="tag" class="qa-tag-link">convection-diffusion</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/diffusion" rel="tag" class="qa-tag-link">diffusion</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/coefficient" rel="tag" class="qa-tag-link">coefficient</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/demo" rel="tag" class="qa-tag-link">demo</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/ufl" rel="tag" class="qa-tag-link">ufl</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../10704/advection-diffusion-coefficient" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2016-07-19T17:51:12+0000"></span>Jul 19, 2016</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/Pama328" class="qa-user-link url nickname">Pama328</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">480</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
												<br>
												<span class="qa-q-view-what">edited</span>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="updated"><span class="value-title" title="2016-07-20T13:43:16+0000"></span>Jul 20, 2016</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span><span class="qa-q-view-who-data"><a href="../../user/Pama328" class="qa-user-link url nickname">Pama328</a></span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c10704_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516467074-60fcac6c550c2c9c0f767f7d62306b61f776ba29">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer answer-selected qa-a-list-item-selected" id="a10719">
									<form method="post" action="../../10704/advection-diffusion-coefficient">
										<div class="qa-voting qa-voting-net" id="voting_10719">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516467074-f51c3d1f7964be2c0c91a1bdf4add8e529d7108d">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../10704/advection-diffusion-coefficient">
											<div class="qa-a-item-selected">
												<div class="qa-a-selection">
													<div class="qa-a-selected">&#160;</div>
													<div class="qa-a-selected-text">Best answer</div>
												</div>
												<div class="qa-a-item-content">
													<a name="10719"></a><div class="entry-content"><p>Hello,</p>

<p>You may find more knowledge in Chapter 31 of Fenics Book. From what it looks like, (0.5) used in linear and bilinear form comes from some time discretization scheme. In Fenics Book, they use Crank Nicolson with 'theta = 0.5'. </p>

<p>Here, 'c' and 'k' may just be variables which if written directly in the form will complicate it or they may be specific parameters related to the problem, but it is unlikely that they would define them like that in the UFL. </p>
</div>
												</div>
												<span class="qa-a-item-avatar-meta">
													<span class="qa-a-item-avatar">
														<a href="../../user/Chaitanya_Raj_Goyal" class="qa-avatar-link"><img src="../../?qa=image&amp;qa_blobid=5557427273671820211&amp;qa_size=40" width="40" height="25" class="qa-avatar-image" alt=""></a>
													</span>
													<span class="qa-a-item-meta">
														<a href="../../10704/advection-diffusion-coefficient?show=10719#a10719" class="qa-a-item-what">answered</a>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2016-07-20T22:35:01+0000"></span>Jul 21, 2016</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span>
															<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/Chaitanya_Raj_Goyal" class="qa-user-link url nickname">Chaitanya_Raj_Goyal</a></span></span>
															<span class="qa-a-item-who-title">FEniCS User</span>
															<span class="qa-a-item-who-points">
																<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">4,150</span><span class="qa-a-item-who-points-pad"> points)</span>
															</span>
														</span>
														<br>
														<span class="qa-a-item-what">selected</span>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="updated"><span class="value-title" title="2016-07-23T02:08:33+0000"></span>Jul 23, 2016</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span><span class="qa-a-item-who-data"><a href="../../user/Pama328" class="qa-user-link url nickname">Pama328</a></span>
														</span>
													</span>
												</span>
											</div>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c10719_list">
												<div class="qa-c-list-item  hentry comment" id="c10725">
													<div class="qa-c-item-content">
														<a name="10725"></a><div class="entry-content"><p>Thanks, the reference to the Fenics book helped a lot.</p>

<p>After reading this chapter I guess that c could be the diffusion coefficient and k could be the time intervall delta t which is necessary for time stepping. Would you agree?</p>

<p>And if I'm not mistaken it should also work if I set them manually in the cpp code after declaring it in the UFL-File via </p>

<pre><code>c = Coefficient(scalar)
k = Coefficient(scalar)
</code></pre>

<p>?</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../10704/advection-diffusion-coefficient?show=10725#c10725" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2016-07-21T18:45:12+0000"></span>Jul 21, 2016</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Pama328" class="qa-user-link url nickname">Pama328</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">480</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c10727">
													<div class="qa-c-item-content">
														<a name="10727"></a><div class="entry-content"><p>I cannot comment on the first assumption because I have not studied the problem but take a look at bottom of page 59 here:</p>

<p><a rel="nofollow" href="https://hplgit.github.io/fenics-tutorial/doc/pub/fenics-tutorial-4print.pdf">https://hplgit.github.io/fenics-tutorial/doc/pub/fenics-tutorial-4print.pdf</a></p>

<p>Your second assumption is correct.</p>

<p>Hope this solves your problem.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-avatar">
																<a href="../../user/Chaitanya_Raj_Goyal" class="qa-avatar-link"><img src="../../?qa=image&amp;qa_blobid=5557427273671820211&amp;qa_size=20" width="20" height="12" class="qa-avatar-image" alt=""></a>
															</span>
															<span class="qa-c-item-meta">
																<a href="../../10704/advection-diffusion-coefficient?show=10727#c10727" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2016-07-22T00:24:18+0000"></span>Jul 22, 2016</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Chaitanya_Raj_Goyal" class="qa-user-link url nickname">Chaitanya_Raj_Goyal</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">4,150</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c10730">
													<div class="qa-c-item-content">
														<a name="10730"></a><div class="entry-content"><p>Thanks, that also helped a lot.</p>

<p>Besides;</p>

<pre><code>c = Coefficient(scalar)
</code></pre>

<p>worked, but </p>

<pre><code>k = Coefficient(scalar)
</code></pre>

<p>didn't.</p>

<p>For some reasons (I don't know exactly why) k had to be defined as</p>

<pre><code>k = Constant(cell)
</code></pre>

<p>Do you know why?</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../10704/advection-diffusion-coefficient?show=10730#c10730" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2016-07-23T02:08:30+0000"></span>Jul 23, 2016</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Pama328" class="qa-user-link url nickname">Pama328</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">480</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516467074-86f449f45408bb359b2e38064e7f316f9d059fd3">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>