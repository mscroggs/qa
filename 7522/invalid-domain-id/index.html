<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>Invalid domain id - FEniCS Q&amp;A</title>
		<meta name="description" content="Hi guys, I wrote a little simulation on python using MacOSX and it worked well. Now I want to copy the  ... + [...]*ds(1) Any advice? Best, MaxMeier">
		<meta name="keywords" content="ubuntu,invalid-domain-id">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/7522/invalid-domain-id">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">Invalid domain id</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q7522">
								<form method="post" action="../../7522/invalid-domain-id">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_7522">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516468124-70583c25688133e3887277b4e4b9e37a05160fd7">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../7522/invalid-domain-id">
										<div class="qa-q-view-content">
											<a name="7522"></a><div class="entry-content"><p>Hi guys, </p>

<p>I wrote a little simulation on python using MacOSX and it worked well. Now I want to copy the simulation to ubuntu, but it doesnt work:</p>

<pre><code>Invalid domain id &lt;Mesh of topological dimension 2 (triangles) with 12345 vertices and 123456 cells, ordered&gt;
[...]
ufl.log.UFLException: Invalid domain id &lt;Mesh of topological dimension 2 (triangles) with 12345 vertices and 123456 cells, ordered&gt;.
</code></pre>

<p>Does somebody understand why I cant just copy the .py-file to ubuntu?<br>
It is a 2D-problem in which I declared the domains like: </p>

<pre><code>mesh = RectangleMesh(0.001, 0, a, b, na, nb)
boundary_parts = MeshFunction('size_t', mesh, 1)
boundary_parts.set_all(0)
tol = 1E-14
class Top(SubDomain):
   def inside(self, x, on_boundary):
      return on_boundary and abs(x[1] - b) &lt; tol
top = Top()
top.mark(boundary_parts, 1)
ds = Measure('ds')[boundary_parts]
</code></pre>

<p>The traceback leads to a line where I wrote </p>

<pre><code>a = [...]*dx(mesh) + [...]*ds(1)
</code></pre>

<p>Any advice?</p>

<p>Best,</p>

<p>MaxMeier</p>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/ubuntu" rel="tag" class="qa-tag-link">ubuntu</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/invalid-domain-id" rel="tag" class="qa-tag-link">invalid-domain-id</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../7522/invalid-domain-id" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2015-07-03T11:53:58+0000"></span>Jul 3, 2015</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/MaxMeier" class="qa-user-link url nickname">MaxMeier</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">850</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
												<br>
												<span class="qa-q-view-what">edited</span>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="updated"><span class="value-title" title="2015-07-03T12:17:51+0000"></span>Jul 3, 2015</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span><span class="qa-q-view-who-data"><a href="../../user/MaxMeier" class="qa-user-link url nickname">MaxMeier</a></span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" id="c7522_list">
											<div class="qa-c-list-item  hentry comment" id="c7523">
												<div class="qa-c-item-content">
													<a name="7523"></a><div class="entry-content"><p>Hi, are you running same FEniCS version on both? </p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-avatar">
															<a href="../../user/MiroK" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/f566be3274ec73e3a6dda27bca11631c?s=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
														</span>
														<span class="qa-c-item-meta">
															<a href="../../7522/invalid-domain-id?show=7523#c7523" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-07-03T13:15:52+0000"></span>Jul 3, 2015</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/MiroK" class="qa-user-link url nickname">MiroK</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Expert</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">80,920</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c7527">
												<div class="qa-c-item-content">
													<a name="7527"></a><div class="entry-content"><p>Yes, I am running the latest FEniCS version on both computers (1.5.0).<br>
That's what made me wonder.<br>
I guess there might be some issues with my definition of boundaries but I can't figure out what is wrong about them in my code.</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../7522/invalid-domain-id?show=7527#c7527" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-07-06T08:25:25+0000"></span>Jul 6, 2015</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/MaxMeier" class="qa-user-link url nickname">MaxMeier</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Novice</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">850</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c7528">
												<div class="qa-c-item-content">
													<a name="7528"></a><div class="entry-content"><p>Okay, could you post the complete code (but minimal) code?</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-avatar">
															<a href="../../user/MiroK" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/f566be3274ec73e3a6dda27bca11631c?s=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
														</span>
														<span class="qa-c-item-meta">
															<a href="../../7522/invalid-domain-id?show=7528#c7528" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-07-06T08:26:42+0000"></span>Jul 6, 2015</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/MiroK" class="qa-user-link url nickname">MiroK</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Expert</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">80,920</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c7531">
												<div class="qa-c-item-content">
													<a name="7531"></a><div class="entry-content"><p>Sure, thank you! Here is an example which works on my mac but not on ubuntu:</p>

<pre><code>from dolfin import *
import sys, time, pylab, numpy

#-------------------------discretisation (time, space):-----------------------------#
nr=200
nz=200
del_t=0.001
t_ges=2
R=20
depth=3

#--------------------------------general parameters-------------------------------#
T0 = 0
boltz = Constant(5.67E-14)
kon = Constant(1E-5)

#--------------------------------heat parameters----------------------------------#
P = Constant(100)
source = Expression('P*(1+sin(x[0]))', P=P)

#--------------------------------create mesh-------------------------------------#
mesh = RectangleMesh(0.001,0,R,depth,nr,nz)
boundary_parts = MeshFunction('size_t', mesh, 1)
boundary_parts.set_all(0)

#--------------------------------create functionspace----------------------------#
V = FunctionSpace(mesh, 'Lagrange', 1)

#------------------------------define boundaries---------------------------------#
tol = 1E-14
class Top(SubDomain):
    def inside(self, x, on_boundary):
        return on_boundary and abs(x[1] - depth) &lt; tol
top=Top()
top.mark(boundary_parts, 1)

class Bottom(SubDomain):
    def inside(self, x, on_boundary):
        return on_boundary and abs(x[1]) &lt; tol
bot=Bottom()
bot.mark(boundary_parts, 2)

class Mid(SubDomain):
    def inside(self, x, on_boundary):
        return on_boundary and abs(x[0] - 0.001) &lt; tol
mid=Mid()
mid.mark(boundary_parts, 3)

class Edge(SubDomain):
    def inside(self, x, on_boundary):
        return on_boundary and abs(x[0] - R) &lt; tol
edge=Edge()
edge.mark(boundary_parts, 4)

ds = Measure('ds')[boundary_parts]

#------------------------------define functions---------------------------------#
du = TrialFunction(V)
u=Function(V)
u_1=Function(V)
v = TestFunction(V)
r = Expression('x[0]')
theta = 0.5 #1:forward euler, 0: backward euler, 0.5: crank-nicholson

#-------------------------------start conditions--------------------------------#
u0 = Constant(T0)
u = interpolate(u0,V)
u_1 = interpolate(u0,V)

#------------------------------define nonlinear problem-------------------------#
class HeatEquation(NonlinearProblem):
    def __init__(self, a, L):
        NonlinearProblem.__init__(self)
        self.L = L
        self.a = a
    def F(self, b, x):
        assemble(self.L, tensor=b)
    def J(self, A, x):
        assemble(self.a, tensor=A)

def rad(u):
    return (u**4)

#------------------------------compiler parameters-----------------------------#
parameters["form_compiler"]["optimize"]     = True
parameters["form_compiler"]["cpp_optimize"] = True
parameters["form_compiler"]["representation"] = "quadrature"


#------------------------------weak formulation--------------------------------#
a = (u*v + del_t*theta*(Dx(u,0)*Dx(v,0)+Dx(u,1)*Dx(v,1) - (1/r)*v*Dx(u,0)))*dx(mesh)+ del_t*(u-u0)*kon*v*theta*ds(1) + del_t*kon*(u-u0)*v*theta*ds(2) + del_t*theta*boltz*(rad(u)-u0**4)*v*ds(1) + del_t*theta*boltz*(rad(u)-u0**4)*v*ds(2)

L = (u_1*v - del_t*(1-theta)*(Dx(u_1,0)*Dx(v,0)+Dx(u_1,1)*Dx(v,1) - (1/r)*v*Dx(u_1,0)))*dx(mesh) + del_t*v*(source - (1-theta)*(kon)*(u_1-u0) - (1-theta)*(boltz)*(rad(u_1)-u0**4))*ds(1) + del_t*(1-theta)*(-(kon)*(u_1 - u0) - (boltz)*(rad(u_1)-u0**4))*v*ds(2)

F = a - L               #=0

J = derivative(F,u,du)  #gateaux derivative

problem = HeatEquation(J,F)

#-----------------------------solver and solver parameters--------------------#
solver = NewtonSolver()
#solver.parameters["linear_solver"] = "lu"
solver.parameters["convergence_criterion"] = "incremental"
solver.parameters["relative_tolerance"] = 1e-6


#------------------------------solve problem---------------------------------#
t = del_t
while t &lt;= t_ges:
    u_1.vector()[:] = u.vector()
    solver.solve(problem, u.vector())
    plot(u, mode='color', window_width=900, window_height=600)
    t+=del_t

interactive()
</code></pre>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../7522/invalid-domain-id?show=7531#c7531" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-07-07T12:21:35+0000"></span>Jul 7, 2015</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/MaxMeier" class="qa-user-link url nickname">MaxMeier</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Novice</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">850</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
															<br>
															<span class="qa-c-item-what">edited</span>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="updated"><span class="value-title" title="2015-07-07T12:31:23+0000"></span>Jul 7, 2015</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span><span class="qa-c-item-who-data"><a href="../../user/MaxMeier" class="qa-user-link url nickname">MaxMeier</a></span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c7532">
												<div class="qa-c-item-content">
													<a name="7532"></a><div class="entry-content"><p>Finally I could fix it on my own; I still don't get why it works now and didn't work before.<br>
All I had to do was to change</p>

<pre><code>a=...*dx(mesh)
</code></pre>

<p>to </p>

<pre><code>dx = Measure('dx')[boundary_parts]
a = ...*dx()
</code></pre>

<p>Of course, I had to change L equally.</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../7522/invalid-domain-id?show=7532#c7532" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-07-07T13:18:32+0000"></span>Jul 7, 2015</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/MaxMeier" class="qa-user-link url nickname">MaxMeier</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Novice</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">850</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
															<br>
															<span class="qa-c-item-what">edited</span>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="updated"><span class="value-title" title="2015-07-07T13:32:25+0000"></span>Jul 7, 2015</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span><span class="qa-c-item-who-data"><a href="../../user/MaxMeier" class="qa-user-link url nickname">MaxMeier</a></span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516468124-ddee919ad69e03491206d16e695c43ba881c2b93">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title" style="display:none;"></h2>
							<div class="qa-a-list" id="a_list">
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>