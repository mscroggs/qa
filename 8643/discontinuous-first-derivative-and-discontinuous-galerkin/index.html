<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>Discontinuous first derivative and discontinuous Galerkin - FEniCS Q&amp;A</title>
		<meta name="description" content="For the solution $\psi$ of my PDE, I would like 1. $\psi$ to be continuous  ... /fenicsproject.org/qa/3299/discontinuous-derivatives?show=3299#q3299 )">
		<meta name="keywords" content="discontinuous,discontinuity">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/8643/discontinuous-first-derivative-and-discontinuous-galerkin">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">Discontinuous first derivative and discontinuous Galerkin</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q8643">
								<form method="post" action="../../8643/discontinuous-first-derivative-and-discontinuous-galerkin">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_8643">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+2<span class="votes-up"><span class="value-title" title="2"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516468184-c78455ebd17b18065cb950d42ef67fbd331ba719">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../8643/discontinuous-first-derivative-and-discontinuous-galerkin">
										<div class="qa-q-view-content">
											<a name="8643"></a><div class="entry-content"><p>For the solution $\psi$ of my PDE, I would like </p>

<ol>
<li>$\psi$ to be continuous </li>
<li>$\frac1{m}\frac{\partial \psi}{\partial x}$ to be continuous, where <code>m</code> is a piecewise constant material parameter<br>
(I can provide more information if needed)</li>
</ol>

<p>Now I wonder if this is possible in FEniCS, and if so how? As I understand, a continuous first derivative would require Hermite basis functions (which are not supported, and even then would not allow for condition 2 on the interface where m changes value). So is there another option? If both are not possible I prefer condition 2 as a strong requirement above condition 1.</p>

<p>And if the solution would involve discontinuous Galerkin methods, is there a recommended hands-on introduction to these somewhere?</p>

<p>(related question: <a rel="nofollow" href="http://fenicsproject.org/qa/3299/discontinuous-derivatives?show=3299#q3299">http://fenicsproject.org/qa/3299/discontinuous-derivatives?show=3299#q3299</a> )</p>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/discontinuous" rel="tag" class="qa-tag-link">discontinuous</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/discontinuity" rel="tag" class="qa-tag-link">discontinuity</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../8643/discontinuous-first-derivative-and-discontinuous-galerkin" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2015-11-20T11:23:36+0000"></span>Nov 20, 2015</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/maartent" class="qa-user-link url nickname">maartent</a></span></span>
													<span class="qa-q-view-who-title">FEniCS User</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">3,910</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c8643_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516468184-be446d7981b09d68779570e381737bed8351f00b">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer" id="a8651">
									<form method="post" action="../../8643/discontinuous-first-derivative-and-discontinuous-galerkin">
										<div class="qa-voting qa-voting-net" id="voting_8651">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516468184-c78455ebd17b18065cb950d42ef67fbd331ba719">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../8643/discontinuous-first-derivative-and-discontinuous-galerkin">
											<div class="qa-a-selection">
											</div>
											<div class="qa-a-item-content">
												<a name="8651"></a><div class="entry-content"><p>If you have first or second order PDE and you use the Galerkin method, you only need elements with C0 continuity to reach what you want (1. and 2.). (For example have a look at the Poisson demo.)</p>

<p>If you have a higher order PDE, you cannot you FEniCS with the standard Galerkin method.<br>
E.g. in case of a fourth order PDE (like the biharmonic equation) you would need C1 continuity if you used the standard Galerkin method (Hermite basis functions are suitable to that). However with a Discontinuous Galerkin method you are able to satisfy 1. and 2. with only C0 continuous elements or discontinuous elements. </p>
</div>
											</div>
											<span class="qa-a-item-avatar-meta">
												<span class="qa-a-item-meta">
													<a href="../../8643/discontinuous-first-derivative-and-discontinuous-galerkin?show=8651#a8651" class="qa-a-item-what">answered</a>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2015-11-22T14:54:32+0000"></span>Nov 22, 2015</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span>
														<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/str" class="qa-user-link url nickname">str</a></span></span>
														<span class="qa-a-item-who-title">FEniCS User</span>
														<span class="qa-a-item-who-points">
															<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">1,600</span><span class="qa-a-item-who-points-pad"> points)</span>
														</span>
													</span>
												</span>
											</span>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c8651_list">
												<div class="qa-c-list-item  hentry comment" id="c8657">
													<div class="qa-c-item-content">
														<a name="8657"></a><div class="entry-content"><p>Could you elaborate a little on the first paragraph? To my understanding, C0 (eg. Lagrange polynomials of any order) will by definition fulfill condition 1, but at the element boundaries the first derivative will always be discontinuous, no?</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../8643/discontinuous-first-derivative-and-discontinuous-galerkin?show=8657#c8657" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-11-23T12:27:19+0000"></span>Nov 23, 2015</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/maartent" class="qa-user-link url nickname">maartent</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">3,910</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c8691">
													<div class="qa-c-item-content">
														<a name="8691"></a><div class="entry-content"><p>I forgot to mention the fact, that the 2nd condition is only satisfied weakly since you seek your solution in a Sobolev space. So the derivatives on the boundaries will be weakly continuous. Do you really need strong continuity?  </p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../8643/discontinuous-first-derivative-and-discontinuous-galerkin?show=8691#c8691" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-11-26T10:43:52+0000"></span>Nov 26, 2015</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/str" class="qa-user-link url nickname">str</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">1,600</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c8692">
													<div class="qa-c-item-content">
														<a name="8692"></a><div class="entry-content"><p>My main concern is a conserved flux, which is guaranteed if condition 2 is fulfilled in this case. But since there is no <em>strong</em> way to demand this, my guess is that I will have to use discontinuous Galerkin methods?<br>
I am new to DG methods however, so any pointing to good tutorials will be helpful.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../8643/discontinuous-first-derivative-and-discontinuous-galerkin?show=8692#c8692" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-11-26T10:49:24+0000"></span>Nov 26, 2015</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/maartent" class="qa-user-link url nickname">maartent</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">3,910</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c8693">
													<div class="qa-c-item-content">
														<a name="8693"></a><div class="entry-content"><p>Galerkin methods are based on Sobolev spaces, so from that point of view using the Discontinuous Galerkin method makes no difference. If you have a first order problem, with the Galerkin you can guarantee your (1) condition strongly and (2) weakly; with discontinuous elments you satisfy both of them weakly. </p>

<p>I think it might be worth to consider whether it is enough to fulfill (2) weakly to have a conserved flux.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../8643/discontinuous-first-derivative-and-discontinuous-galerkin?show=8693#c8693" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-11-26T11:00:37+0000"></span>Nov 26, 2015</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/str" class="qa-user-link url nickname">str</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">1,600</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c8696">
													<div class="qa-c-item-content">
														<a name="8696"></a><div class="entry-content"><p>Taking the mesh fine enough, CG does a good enough job in conserving the flux indeed. But from what I read about DG so far, its strength is that, although in a <em>weak</em> way, it does a better job at conserving fluxes at a same computational cost (i.e. it is more useful to use a DG method than to use a finer mesh). Please correct me if I am wrong here.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../8643/discontinuous-first-derivative-and-discontinuous-galerkin?show=8696#c8696" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-11-26T11:18:34+0000"></span>Nov 26, 2015</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/maartent" class="qa-user-link url nickname">maartent</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">3,910</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c8697">
													<div class="qa-c-item-content">
														<a name="8697"></a><div class="entry-content"><p>Your last comment modified my understanding of your original question: <br>
So you have a CG implementation of you first order problem and worried about condition (2) therefore you want to move forward to DG hoping that it would be more efficient. If your CG implementation works I wouldn't worry about the weak derivatives (meaning that there is no need to use Hermite polynomials). I don't have an information about the computational cost but it might worth to compare the Poisson and the DG Poisson demo. </p>

<p>To get the idea of the DG method I would recommend reading the first chapter of the book of Riviere (especially from page 3 to 6). Then it worth reading the documentation of the biharmonic demo and then checking the undocumented DG Poisson demo. </p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../8643/discontinuous-first-derivative-and-discontinuous-galerkin?show=8697#c8697" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-11-26T11:44:52+0000"></span>Nov 26, 2015</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/str" class="qa-user-link url nickname">str</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">1,600</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c8699">
													<div class="qa-c-item-content">
														<a name="8699"></a><div class="entry-content"><p>Thanks. I'll have a look.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../8643/discontinuous-first-derivative-and-discontinuous-galerkin?show=8699#c8699" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-11-26T13:58:09+0000"></span>Nov 26, 2015</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/maartent" class="qa-user-link url nickname">maartent</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">3,910</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516468184-37e9672ad730c1a3f97d10199d10fa65d2676f04">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>