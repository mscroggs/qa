<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>Coupling two different fields at the interface of two domains - FEniCS Q&amp;A</title>
		<meta name="description" content="I am trying to solver some simplified fluid-structure coupling, considering the displacement field  ...  the Multimesh approach, without success...">
		<meta name="keywords" content="coupled-regions">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/13251/coupling-two-different-fields-at-the-interface-two-domains">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">Coupling two different fields at the interface of two domains</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q13251">
								<form method="post" action="../../13251/coupling-two-different-fields-at-the-interface-two-domains">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_13251">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516467858-c826adaff9dadf43af1bfd19777ebd71b7218ee8">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../13251/coupling-two-different-fields-at-the-interface-two-domains">
										<div class="qa-q-view-content">
											<a name="13251"></a><div class="entry-content"><p>I am trying to solver some simplified fluid-structure coupling, considering the displacement field $u$ in the (linearly elastic) solid domain $\Omega_s$, and the displacement potential $\varphi$ Euler equation in the fluid domain $\Omega_f$. These quatities are coupled at the interface $\Gamma$ of the two (non-overlapping) domains, accounting for the continuity of the normal displacement ($u\cdot n=\nabla\varphi\cdot n$) and normal stress ($\sigma(u)\cdot(n) = \rho_f \omega^2 \phi n$).</p>

<p>Basically, the eigenproblem writes as :<br>
Find $u$ and $\varphi$ in the respective function spaces such as <br>
$$ k_s(u, v) = \lambda (m_s(u, v) + c(\varphi, v) \,\forall v,$$<br>
and<br>
$$ m_f(\varphi, \psi) = c(\psi, u)\,\forall\psi$$</p>

<p>with</p>

<ul>
<li>$m_s(u,v)=\int_{\Omega_s} \rho_s u\cdot v$ the solid mass operator</li>
<li>$k_s(u, v)=\int_{\Omega_s} \sigma(u):\varepsilon(v)$ the solid stiffness operator</li>
<li>$m_f(\varphi,\psi)=\int_{\Omega_f } \rho_f \nabla \varphi\cdot\nabla\psi$ the fluid mass operator</li>
<li>$c(\psi, u)=\int_\Gamma \rho_f \psi (u\cdot n)$ the coupling operator</li>
</ul>

<p>I am struggling with this last operator as it involves two different fields on two different domains and meshes. By now I am wondering what would be the best approach to that problem ? I have been considering the Multimesh approach, without success...</p>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/coupled-regions" rel="tag" class="qa-tag-link">coupled-regions</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../13251/coupling-two-different-fields-at-the-interface-two-domains" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2017-04-27T12:55:29+0000"></span>Apr 27, 2017</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/fabricios" class="qa-user-link url nickname">fabricios</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">120</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
												<br>
												<span class="qa-q-view-what">edited</span>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="updated"><span class="value-title" title="2017-04-27T15:02:24+0000"></span>Apr 27, 2017</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span><span class="qa-q-view-who-data"><a href="../../user/fabricios" class="qa-user-link url nickname">fabricios</a></span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" id="c13251_list">
											<div class="qa-c-list-item  hentry comment" id="c13252">
												<div class="qa-c-item-content">
													<a name="13252"></a><div class="entry-content"><p>Hi, is the last equation correct, more concretely, shouldn't it be $u$ instead of $v$? Also, supposing that the problem is assembled how does one solve this constrained eigenvalue problem? Anyways, to assemble the system in FEniCS takes a bit of hacking - it is unfortunately not something you can do on UFL level but it is possible by putting the system together in terms of block matrices. </p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-avatar">
															<a href="../../user/MiroK" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/f566be3274ec73e3a6dda27bca11631c?s=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
														</span>
														<span class="qa-c-item-meta">
															<a href="../../13251/coupling-two-different-fields-at-the-interface-two-domains?show=13252#c13252" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2017-04-27T14:46:12+0000"></span>Apr 27, 2017</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/MiroK" class="qa-user-link url nickname">MiroK</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Expert</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">80,920</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c13253">
												<div class="qa-c-item-content">
													<a name="13253"></a><div class="entry-content"><p>Indeed, it is the trial function u in the coupling operator (corrected)</p>

<p>This is known as an added-mass proble: the coupling acts as an inertial loading on the solid. For a given solid displacement, the normal displacement of the interface can be seen as a Dirichlet boundary condition for the fluid problem. Solving the latter provides the effort that the fluid applies to the solid on the interface.</p>

<p>I am able to deal with this problem using Freefem (see <a rel="nofollow" href="https://hal.archives-ouvertes.fr/hal-01361859">https://hal.archives-ouvertes.fr/hal-01361859</a> for details and some numerical results), but I wanted to check those results and learn some fenics by the way.</p>

<p>Freefem is not puzzled by bilinear forms mixing fields from differents finite element space (implicit interpolation is performed under the hood), but I did not succeed to assemble the system using Fenics...</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../13251/coupling-two-different-fields-at-the-interface-two-domains?show=13253#c13253" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2017-04-27T15:01:54+0000"></span>Apr 27, 2017</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/fabricios" class="qa-user-link url nickname">fabricios</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Novice</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">120</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c13254">
												<div class="qa-c-item-content">
													<a name="13254"></a><div class="entry-content"><p>Thanks for sharing the reference. As I said, implementing the problem in FEniCS requires more or less manual assembly of the coupling terms. <a rel="nofollow" href="https://github.com/MiroK/fenics_ii/blob/master/py/helmholtz.py">This</a> might serve as a decent starting point.</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-avatar">
															<a href="../../user/MiroK" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/f566be3274ec73e3a6dda27bca11631c?s=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
														</span>
														<span class="qa-c-item-meta">
															<a href="../../13251/coupling-two-different-fields-at-the-interface-two-domains?show=13254#c13254" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2017-04-27T15:20:13+0000"></span>Apr 27, 2017</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/MiroK" class="qa-user-link url nickname">MiroK</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Expert</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">80,920</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c13263">
												<div class="qa-c-item-content">
													<a name="13263"></a><div class="entry-content"><p>Thank you for sharing the assembly script.<br>
As a matter of fact, I do not need to perform the assembly, as, in the added-mass problem, the fluid potential is eliminated (by a Schur complement procedure). See Eq. (11) in page 5 of the paper.<br>
The resulting matrix would be dense (on the interface dofs), and is thus not assembled. The eigenproblem is solved using the functional interface of arpack, i.e., looking for the generalized eigen solutions of two linear operators. The stiffness operator is trivial, but the mass operator is as follows :</p>

<pre><code>def mass_operator(vector u):
  phi = solve(Mf, dot(C, u))
  added_load = dot(C.T, phi)
  return dot(Ms, u) + added_load
</code></pre>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../13251/coupling-two-different-fields-at-the-interface-two-domains?show=13263#c13263" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2017-04-28T10:06:09+0000"></span>Apr 28, 2017</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/fabricios" class="qa-user-link url nickname">fabricios</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Novice</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">120</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c13283">
												<div class="qa-c-item-content">
													<a name="13283"></a><div class="entry-content"><p>Dear MiroK,<br>
as far as I understand it, your answer only gives clues for an eventual assembly step (that I do not care about as explained in the previous comment).<br>
At the moment, I am still puzzled about waht would be the correct approach to compute the coupling operator $c$ that applies on two fields defined on different meshes which are supposed to be adjacent (non overlapping fluid and solid domains).<br>
Is it necessary to define the two fields on a common domain that would span the solid and fluid regions ?<br>
It seems to be overkill in terms of number of dofs, and would require a proper elimination of the unneeded dofs for the fluid variable in order for the added mass operator to be correctly defined. In the previous comment, we are to solve<br>
$$M_f \cdot \varphi = C\cdot u$$<br>
for a given $u$ which is usually possible as $M_f$ is invertible (as long as a DirichletBC applies on some part of the fluid boundary)...</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../13251/coupling-two-different-fields-at-the-interface-two-domains?show=13283#c13283" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2017-05-02T12:50:56+0000"></span>May 2, 2017</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/fabricios" class="qa-user-link url nickname">fabricios</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Novice</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">120</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516467858-4c0b5dba5810dc7dcf2d223e44f0b868852375a5">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title" style="display:none;"></h2>
							<div class="qa-a-list" id="a_list">
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>