<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>How to create a dolfin function that operates on vertex index rather than position - FEniCS Q&amp;A</title>
		<meta name="description" content="Is it possible to create a dolfin function that operates on the index of a vertex rather than  ... like to use this function in a boundary condition.">
		<meta name="keywords" content="funciton,boundary-conditions,vertex">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/11666/create-dolfin-function-operates-vertex-index-rather-position">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">How to create a dolfin function that operates on vertex index rather than position</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q11666">
								<form method="post" action="../../11666/create-dolfin-function-operates-vertex-index-rather-position">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_11666">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516467779-222a9f7501b6b0032f1b8d2e51c5c5426e4515b4">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../11666/create-dolfin-function-operates-vertex-index-rather-position">
										<div class="qa-q-view-content">
											<a name="11666"></a><div class="entry-content"><p>Is it possible to create a dolfin function that operates on the index of a vertex rather than its position coordinates?  It appears that the GenericFunction class only allows you to implement the eval function which takes coordinates of a point rather than the index of a vertex.</p>

<p>I would like to use this function in a boundary condition.</p>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/funciton" rel="tag" class="qa-tag-link">funciton</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/boundary-conditions" rel="tag" class="qa-tag-link">boundary-conditions</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/vertex" rel="tag" class="qa-tag-link">vertex</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-avatar">
												<a href="../../user/rviertel" class="qa-avatar-link"><img src="../../?qa=image&amp;qa_blobid=10721583502098350530&amp;qa_size=50" width="38" height="50" class="qa-avatar-image" alt=""></a>
											</span>
											<span class="qa-q-view-meta">
												<a href="../../11666/create-dolfin-function-operates-vertex-index-rather-position" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2016-11-17T16:16:13+0000"></span>Nov 17, 2016</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/rviertel" class="qa-user-link url nickname">rviertel</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">700</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c11666_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516467779-4257ad41b6e4a5129f72104a94d3a0780118077d">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer" id="a11667">
									<form method="post" action="../../11666/create-dolfin-function-operates-vertex-index-rather-position">
										<div class="qa-voting qa-voting-net" id="voting_11667">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516467779-222a9f7501b6b0032f1b8d2e51c5c5426e4515b4">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../11666/create-dolfin-function-operates-vertex-index-rather-position">
											<div class="qa-a-selection">
											</div>
											<div class="qa-a-item-content">
												<a name="11667"></a><div class="entry-content"><p>Consider a <a rel="nofollow" href="https://fenicsproject.org/documentation/dolfin/2016.1.0/python/programmers-reference/cpp/mesh/MeshFunctionSizet.html#dolfin.cpp.mesh.MeshFunctionSizet">VertexFunction</a>. This subtype of <code>MeshFunction</code> has values only defined at vertices of the mesh, indexed by the vertices of the mesh.</p>

<pre><code>from dolfin import *

mesh = UnitSquareMesh(4, 4)

vf = VertexFunction('size_t', mesh, 0)

for v in vertices(mesh):
  vf[v] = v.index()

print vf.array()
</code></pre>

<p>Bear in mind that boundary conditions are naturally applied to facets: e.g.</p>

<pre><code> ff = FacetFunction('size_t', mesh, 0)
 ds = Measure('ds', subdomain_data=ff)
</code></pre>

<p>Is is possible to apply boundary conditions to pointwise data. But this must be done geometrically using <code>DirichletBC</code> I believe. Someone may correct me.</p>
</div>
											</div>
											<span class="qa-a-item-avatar-meta">
												<span class="qa-a-item-avatar">
													<a href="../../user/nate" class="qa-avatar-link"><img src="../../?qa=image&amp;qa_blobid=969593914916706065&amp;qa_size=40" width="40" height="40" class="qa-avatar-image" alt=""></a>
												</span>
												<span class="qa-a-item-meta">
													<a href="../../11666/create-dolfin-function-operates-vertex-index-rather-position?show=11667#a11667" class="qa-a-item-what">answered</a>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2016-11-17T17:06:15+0000"></span>Nov 17, 2016</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span>
														<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/nate" class="qa-user-link url nickname">nate</a></span></span>
														<span class="qa-a-item-who-title">FEniCS Expert</span>
														<span class="qa-a-item-who-points">
															<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">17,050</span><span class="qa-a-item-who-points-pad"> points)</span>
														</span>
													</span>
												</span>
											</span>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c11667_list">
												<div class="qa-c-list-item  hentry comment" id="c11668">
													<div class="qa-c-item-content">
														<a name="11668"></a><div class="entry-content"><p>Assuming that I use a P1 lagrange element then are not the boundary conditions naturally applied to boundary nodes not facets?</p>

<p>I had considered using the DirichletBC class in conjunction with a VertexFunction, but DirichletBC only takes a GeneralFunction as an argument, which requires point data, mesh functions can only be used with it to specify the boundary.  Are there any other classes that can be used to specify a boundary condition?</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-avatar">
																<a href="../../user/rviertel" class="qa-avatar-link"><img src="../../?qa=image&amp;qa_blobid=10721583502098350530&amp;qa_size=20" width="15" height="20" class="qa-avatar-image" alt=""></a>
															</span>
															<span class="qa-c-item-meta">
																<a href="../../11666/create-dolfin-function-operates-vertex-index-rather-position?show=11668#c11668" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2016-11-17T18:05:36+0000"></span>Nov 17, 2016</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/rviertel" class="qa-user-link url nickname">rviertel</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">700</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c11669">
													<div class="qa-c-item-content">
														<a name="11669"></a><div class="entry-content"><p>Boundary conditions are applied to facets. You must integrate the basis of your FE solution space over subsets of the exterior boundary to compute boundary terms. You may be interested in applying <code>DirichletBC</code> "pointwise" as I suggested. Documentation <a rel="nofollow" href="https://fenicsproject.org/documentation/dolfin/dev/python/programmers-reference/fem/bcs/DirichletBC.html">here</a>.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-avatar">
																<a href="../../user/nate" class="qa-avatar-link"><img src="../../?qa=image&amp;qa_blobid=969593914916706065&amp;qa_size=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
															</span>
															<span class="qa-c-item-meta">
																<a href="../../11666/create-dolfin-function-operates-vertex-index-rather-position?show=11669#c11669" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2016-11-17T18:09:53+0000"></span>Nov 17, 2016</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/nate" class="qa-user-link url nickname">nate</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Expert</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">17,050</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516467779-3e7c4cd845ed0e12086b5349ba70c0f15ab919b3">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>