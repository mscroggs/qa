<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>What is the advantage of handling domains with different materials using subdomains? - FEniCS Q&amp;A</title>
		<meta name="description" content="Dear all, So I have been looking at the tutorial about using subdomains and there must be something I  ... as follows: def isInRegion1(x): return x[1]">
		<meta name="keywords" content="subdomains">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/5288/advantage-handling-domains-different-materials-subdomains">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">What is the advantage of handling domains with different materials using subdomains?</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q5288">
								<form method="post" action="../../5288/advantage-handling-domains-different-materials-subdomains">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_5288">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+2<span class="votes-up"><span class="value-title" title="2"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516468023-6454ad1270e63b40b8160b579a99230a54fe5346">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../5288/advantage-handling-domains-different-materials-subdomains">
										<div class="qa-q-view-content">
											<a name="5288"></a><div class="entry-content"><p>Dear all,</p>

<p>So I have been looking at the tutorial about using subdomains and there must be something I do not understand because I have always been doing as follows:</p>

<pre><code>def isInRegion1(x):
    return   x[1]&lt;0.5e-2 

class MyCrossSection(Expression):
    def eval(self, value, x):
        if  isInRegion1(x):
            value[0] = sigma_t_1
        else:
            value[0] = sigma_t_2

    def value_shape(self):
        return (1,)

Sigma_t = MyCrossSection()
...
a += (Sigma_t[0]+1/(c*dt))*psi*v*dx  # some component of the bilinear form
</code></pre>

<p>Which seems easier to me to use than subdomains.</p>

<p>So I probably don't get the full potential of using subdomains. Are there cases in which subdomains could help do something that the method above could not? </p>

<p>Thanks a lot!<br>
Vincent</p>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/subdomains" rel="tag" class="qa-tag-link">subdomains</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../5288/advantage-handling-domains-different-materials-subdomains" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2014-09-03T22:16:35+0000"></span>Sep 4, 2014</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/V_L" class="qa-user-link url nickname">V_L</a></span></span>
													<span class="qa-q-view-who-title">FEniCS User</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">4,440</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c5288_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516468023-86894cad2896cccda89c979631166502934814d3">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">3 Answers</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer answer-selected qa-a-list-item-selected" id="a5326">
									<form method="post" action="../../5288/advantage-handling-domains-different-materials-subdomains">
										<div class="qa-voting qa-voting-net" id="voting_5326">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+1<span class="votes-up"><span class="value-title" title="1"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516468023-6454ad1270e63b40b8160b579a99230a54fe5346">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../5288/advantage-handling-domains-different-materials-subdomains">
											<div class="qa-a-item-selected">
												<div class="qa-a-selection">
													<div class="qa-a-selected">&#160;</div>
													<div class="qa-a-selected-text">Best answer</div>
												</div>
												<div class="qa-a-item-content">
													<a name="5326"></a><div class="entry-content"><p>Hi,</p>

<p>I personally prefer the subdomains approach, as it allows me to write one version of the weak form and specify material regions programmatically (by subclassing <code>SubDomain</code> and manually marking the subdomains <code>MeshFunction</code> as described in the tutorial) in simple cases, while use GMSH for more complicated material regions (to be honest, I use GMSH even for simpler regions as I like to see what is marked before I run the calculation). </p>

<p>So I typically create a mesh and specify physical regions in GMSH, run the .msh file through <code>dolfin_convert</code> and just use</p>

<blockquote>
  <p>subdomains = MeshFunction("size_t", mesh, "mesh_physical_regions.xml")</p>
</blockquote>

<p>with the generated physical regions file (analogous approach can be used also for boundaries).</p>
</div>
												</div>
												<span class="qa-a-item-avatar-meta">
													<span class="qa-a-item-meta">
														<a href="../../5288/advantage-handling-domains-different-materials-subdomains?show=5326#a5326" class="qa-a-item-what">answered</a>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2014-09-05T20:54:33+0000"></span>Sep 5, 2014</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span>
															<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/mhanus" class="qa-user-link url nickname">mhanus</a></span></span>
															<span class="qa-a-item-who-title">FEniCS Novice</span>
															<span class="qa-a-item-who-points">
																<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">930</span><span class="qa-a-item-who-points-pad"> points)</span>
															</span>
														</span>
														<br>
														<span class="qa-a-item-what">selected</span>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="updated"><span class="value-title" title="2014-09-08T14:49:42+0000"></span>Sep 8, 2014</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span><span class="qa-a-item-who-data"><a href="../../user/V_L" class="qa-user-link url nickname">V_L</a></span>
														</span>
													</span>
												</span>
											</div>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c5326_list">
												<div class="qa-c-list-item  hentry comment" id="c5351">
													<div class="qa-c-item-content">
														<a name="5351"></a><div class="entry-content"><p>I think I better understand why using subdomains is preferable, thanks a lot!</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../5288/advantage-handling-domains-different-materials-subdomains?show=5351#c5351" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-09-08T14:50:57+0000"></span>Sep 8, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/V_L" class="qa-user-link url nickname">V_L</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">4,440</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516468023-8896eea4daaf25bbbca7c1ccc186df6df8d624a7">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
								<div class="qa-a-list-item  hentry answer" id="a5289">
									<form method="post" action="../../5288/advantage-handling-domains-different-materials-subdomains">
										<div class="qa-voting qa-voting-net" id="voting_5289">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+1<span class="votes-up"><span class="value-title" title="1"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516468023-6454ad1270e63b40b8160b579a99230a54fe5346">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../5288/advantage-handling-domains-different-materials-subdomains">
											<div class="qa-a-selection">
											</div>
											<div class="qa-a-item-content">
												<a name="5289"></a><div class="entry-content"><p>Hi,</p>

<p>I find it convenient to use subdomains when I am dealing with materials with rough, irregular interfaces.  It also means I can write a script that robustly imports different meshes from external specialist mesh programs like GMSH.</p>
</div>
											</div>
											<span class="qa-a-item-avatar-meta">
												<span class="qa-a-item-meta">
													<a href="../../5288/advantage-handling-domains-different-materials-subdomains?show=5289#a5289" class="qa-a-item-what">answered</a>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2014-09-03T22:35:34+0000"></span>Sep 4, 2014</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span>
														<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/sixtysymbols" class="qa-user-link url nickname">sixtysymbols</a></span></span>
														<span class="qa-a-item-who-title">FEniCS User</span>
														<span class="qa-a-item-who-points">
															<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">2,280</span><span class="qa-a-item-who-points-pad"> points)</span>
														</span>
													</span>
												</span>
											</span>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c5289_list">
												<div class="qa-c-list-item  hentry comment" id="c5306">
													<div class="qa-c-item-content">
														<a name="5306"></a><div class="entry-content"><p>Thanks for the answer! :)</p>

<p>What confuses me is that in both cases you need to define a function to explicit what is in a given region and what is not (isInRegion1(x) in the example above and inside(self, x, on_boundary) if using subdomains)</p>

<p>So could you explain to me why the second approach is more robust?</p>

<p>I am asking this because I precisely imported a mesh from GMSH and the solver takes forever (compared to if I use a similar mesh using RectangleMesh) so I am wondering if it is because I should use subdomains or not</p>

<p>Thanks for the help!</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../5288/advantage-handling-domains-different-materials-subdomains?show=5306#c5306" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-09-04T15:28:16+0000"></span>Sep 4, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/V_L" class="qa-user-link url nickname">V_L</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">4,440</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516468023-8ad555522e06dbe821d90ebb9cba0b98071ed5de">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
								<div class="qa-a-list-item  hentry answer" id="a5316">
									<form method="post" action="../../5288/advantage-handling-domains-different-materials-subdomains">
										<div class="qa-voting qa-voting-net" id="voting_5316">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+1<span class="votes-up"><span class="value-title" title="1"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516468023-6454ad1270e63b40b8160b579a99230a54fe5346">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../5288/advantage-handling-domains-different-materials-subdomains">
											<div class="qa-a-selection">
											</div>
											<div class="qa-a-item-content">
												<a name="5316"></a><div class="entry-content"><p>Suppose you have a circular subdomain. Of course you can treat it as above. But  after obtaining the solution,  suppose you want to evaluate an integral on the subdomain, you  can compute it very easily as Fdx(i) where i is ith subdomain  .</p>

<p>You might be able to do this your own way, but I think it will be  painful .</p>
</div>
											</div>
											<span class="qa-a-item-avatar-meta">
												<span class="qa-a-item-meta">
													<a href="../../5288/advantage-handling-domains-different-materials-subdomains?show=5316#a5316" class="qa-a-item-what">answered</a>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2014-09-05T16:14:43+0000"></span>Sep 5, 2014</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span>
														<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/shriram" class="qa-user-link url nickname">shriram</a></span></span>
														<span class="qa-a-item-who-title">FEniCS User</span>
														<span class="qa-a-item-who-points">
															<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">1,540</span><span class="qa-a-item-who-points-pad"> points)</span>
														</span>
													</span>
												</span>
											</span>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c5316_list">
												<div class="qa-c-list-item  hentry comment" id="c5350">
													<div class="qa-c-item-content">
														<a name="5350"></a><div class="entry-content"><p>That's indeed a good reason to use subdomains, thanks!</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../5288/advantage-handling-domains-different-materials-subdomains?show=5350#c5350" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-09-08T14:50:19+0000"></span>Sep 8, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/V_L" class="qa-user-link url nickname">V_L</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">4,440</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516468023-084af3cdf8642ccd0b428a819797519f7144856c">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>