<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>Variational form for inverting a gradient - FEniCS Q&amp;A</title>
		<meta name="description" content="I'm trying to find a vector $ u $ such that $ I + \nabla u = F_Q $, where $  ... variational form? Or is the strong form perhaps not well-specified?">
		<meta name="keywords" content="variational-form,deformation-gradient">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/12486/variational-form-for-inverting-a-gradient">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">Variational form for inverting a gradient</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q12486">
								<form method="post" action="../../12486/variational-form-for-inverting-a-gradient">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_12486">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">&#8211;2<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="2"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516467825-4872f406e32c29616478af5899b8e446c90d7b59">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../12486/variational-form-for-inverting-a-gradient">
										<div class="qa-q-view-content">
											<a name="12486"></a><div class="entry-content"><p>I'm trying to find a vector $ u $ such that $ I + \nabla u = F_Q $, where $ F_Q $ is a known tensor field.</p>

<p>I'm not sure how to get the variational form for such a problem.</p>

<p>My first guess was:</p>

<p>$$ \int (I + \nabla u - F_Q) \cdot \nabla v dx = 0 $$</p>

<p>This is a linear problem, so I can always get some sort of solution with FEniCS. But for some values of $ F_Q $ the solutions seem to be correct within numerical tolerance, and for others they are way off.</p>

<p>Do I have the wrong variational form? Or is the strong form perhaps not well-specified?</p>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/variational-form" rel="tag" class="qa-tag-link">variational-form</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/deformation-gradient" rel="tag" class="qa-tag-link">deformation-gradient</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../12486/variational-form-for-inverting-a-gradient" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2017-02-23T01:19:55+0000"></span>Feb 23, 2017</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/raeneufe" class="qa-user-link url nickname">raeneufe</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">270</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" id="c12486_list">
											<div class="qa-c-list-item  hentry comment" id="c12521">
												<div class="qa-c-item-content">
													<a name="12521"></a><div class="entry-content"><p>What is v? What is your domain? How did you come up with the bilinear form? Looks all like "trying something" to me. You should aim to understand what you are doing. Guessing your solution is almost always wrong.</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../12486/variational-form-for-inverting-a-gradient?show=12521#c12521" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2017-02-25T21:54:50+0000"></span>Feb 25, 2017</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Christian+Waluga" class="qa-user-link url nickname">Christian Waluga</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Expert</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">12,310</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c12522">
												<div class="qa-c-item-content">
													<a name="12522"></a><div class="entry-content"><p>v is the test function. Since the trial function u is a vector, so is v.</p>

<p>The domain is a 3D box.</p>

<p>I got the bilinear and linear forms by calling <code>lhs(...)</code> and <code>rhs(...)</code> on that equation.</p>

<p>And yes, it certainly is "trying something" and I know that my current attempt is wrong.</p>

<p>The point of my question is that I don't know where to start in finding the variational form, and my first guess was unsurprisingly wrong.</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../12486/variational-form-for-inverting-a-gradient?show=12522#c12522" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2017-02-25T23:56:15+0000"></span>Feb 26, 2017</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/raeneufe" class="qa-user-link url nickname">raeneufe</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Novice</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">270</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516467825-6bffcefc712ab6a8dbaaa23c2f318b550ee72fae">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title" style="display:none;"></h2>
							<div class="qa-a-list" id="a_list">
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>