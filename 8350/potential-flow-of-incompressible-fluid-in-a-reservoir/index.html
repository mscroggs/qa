<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>Potential flow of incompressible fluid in a reservoir - FEniCS Q&amp;A</title>
		<meta name="description" content="Hello, Please see below my question that was revised over time. Thanks, Evgeny.">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/8350/potential-flow-of-incompressible-fluid-in-a-reservoir">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">Potential flow of incompressible fluid in a reservoir</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q8350">
								<form method="post" action="../../8350/potential-flow-of-incompressible-fluid-in-a-reservoir">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_8350">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">&#8211;1<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="1"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516468168-48877045798ef9ac17e3762f759cb862dff98423">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../8350/potential-flow-of-incompressible-fluid-in-a-reservoir">
										<div class="qa-q-view-content">
											<a name="8350"></a><div class="entry-content"><p>Hello,</p>

<p>Please see below my question that was revised over time. </p>

<p>Thanks,<br>
Evgeny.</p>
</div>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../8350/potential-flow-of-incompressible-fluid-in-a-reservoir" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2015-10-14T18:06:56+0000"></span>Oct 14, 2015</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/evgeny-petrov" class="qa-user-link url nickname">evgeny-petrov</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">110</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
												<br>
												<span class="qa-q-view-what">edited</span>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="updated"><span class="value-title" title="2015-11-10T07:16:22+0000"></span>Nov 10, 2015</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span><span class="qa-q-view-who-data"><a href="../../user/evgeny-petrov" class="qa-user-link url nickname">evgeny-petrov</a></span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" id="c8350_list">
											<div class="qa-c-list-item  hentry comment" id="c8354">
												<div class="qa-c-item-content">
													<a name="8354"></a><div class="entry-content"><p>What is the question? What do you want to solve for? (u,p,phi), just phi, or is phi given? Is it okay to obtain u via postprocessing or do you really want to solve the incompressible Navier-Stokes equation with vanishing viscosity? You should clarify WHAT you want to do before anybody can give advice on HOW to do it. If you just want to solve for the potential, this is easy and covered in the tutorial (Poisson/Laplace equation).</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../8350/potential-flow-of-incompressible-fluid-in-a-reservoir?show=8354#c8354" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-10-16T06:14:28+0000"></span>Oct 16, 2015</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Christian+Waluga" class="qa-user-link url nickname">Christian Waluga</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Expert</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">12,310</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c8362">
												<div class="qa-c-item-content">
													<a name="8362"></a><div class="entry-content"><p>Let us imagine that we have an ideal fluid in a reservoir, not full, which means there is a free surface of an ideal fluid on top, this reservoir makes no movements.</p>

<p>This problem mathematical formulation may be written as follows:</p>

<p>$$\nabla^2 \phi(x_i) = 0$$ </p>

<p>Boundary condition for wet surface $S$<br>
$$\frac{\partial \phi}{\partial n} = 0 \quad \forall x_i \in S$$ </p>

<p>Boundary condition for a free surface $\Sigma$<br>
$$\frac{\partial \phi}{\partial t} + \frac{1}{2}(\nabla \phi)^2 + g x_1 = 0$$</p>

<p>$$\frac{\partial \phi}{\partial n} = - \frac{1}{\vert \nabla \xi \vert} \frac{\partial \xi}{\partial t}$$</p>

<p>Note, $\xi (x_2, x_3,t)$ -- a free surface function, unknown, but for initial conditions: $\xi^0 (x_2,x_3,0)$ -- given function. $\phi$ and $\xi$ are unknown that I need to compute.</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../8350/potential-flow-of-incompressible-fluid-in-a-reservoir?show=8362#c8362" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-10-17T09:27:29+0000"></span>Oct 17, 2015</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/evgeny-petrov" class="qa-user-link url nickname">evgeny-petrov</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Novice</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">110</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
															<br>
															<span class="qa-c-item-what">edited</span>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="updated"><span class="value-title" title="2015-11-17T10:24:37+0000"></span>Nov 17, 2015</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span><span class="qa-c-item-who-data"><a href="../../user/evgeny-petrov" class="qa-user-link url nickname">evgeny-petrov</a></span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c8367">
												<div class="qa-c-item-content">
													<a name="8367"></a><div class="entry-content"><p>You mix up the divergence and the gradient in your notation. Make sure that you integrate the right hand side by parts for implementation. This should give you Neumann boundary conditions for the problem. Note that you will also have to normalize the constant pressure mode. This is also explained in the tutorial if I remember correctly (via Lagrange multipliers)</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../8350/potential-flow-of-incompressible-fluid-in-a-reservoir?show=8367#c8367" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-10-19T17:25:06+0000"></span>Oct 19, 2015</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Christian+Waluga" class="qa-user-link url nickname">Christian Waluga</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Expert</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">12,310</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c8513">
												<div class="qa-c-item-content">
													<a name="8513"></a><div class="entry-content"><p>Would you please take a look at my boundary problem set up once again? thanks, Evgeny.</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../8350/potential-flow-of-incompressible-fluid-in-a-reservoir?show=8513#c8513" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-11-10T07:25:05+0000"></span>Nov 10, 2015</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/evgeny-petrov" class="qa-user-link url nickname">evgeny-petrov</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Novice</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">110</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516468168-016f56a95b4bb71417263c4bdf06963010862de6">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer" id="a8523">
									<form method="post" action="../../8350/potential-flow-of-incompressible-fluid-in-a-reservoir">
										<div class="qa-voting qa-voting-net" id="voting_8523">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516468168-48877045798ef9ac17e3762f759cb862dff98423">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../8350/potential-flow-of-incompressible-fluid-in-a-reservoir">
											<div class="qa-a-selection">
											</div>
											<div class="qa-a-item-content">
												<a name="8523"></a><div class="entry-content"><p>As a start you should try to derive a weak formulation. In doing so you can identify which boundary conditions are required and what else is missing. Only then you can think about decoupling and discretizing your weak form using suitable ansatz spaces. In the course of this you may also identify further questions. Note that this Q&amp;A format is not intended to solve your modeling problems but rather to provide hints regarding the implementation in FEniCS. The problem with your question is that there is only a model problem with no visible effort to attempt finding a solution. I doubt anyone will find the time to work through this and I think that even now your description is not complete. Try to think about this for yourself and pose digestible questions if you run into problems. Everything that is related to modeling issues may be better suited for e.g. scicomp.stackexchange.com.</p>
</div>
											</div>
											<span class="qa-a-item-avatar-meta">
												<span class="qa-a-item-meta">
													<a href="../../8350/potential-flow-of-incompressible-fluid-in-a-reservoir?show=8523#a8523" class="qa-a-item-what">answered</a>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2015-11-10T22:41:05+0000"></span>Nov 10, 2015</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span>
														<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/Christian+Waluga" class="qa-user-link url nickname">Christian Waluga</a></span></span>
														<span class="qa-a-item-who-title">FEniCS Expert</span>
														<span class="qa-a-item-who-points">
															<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">12,310</span><span class="qa-a-item-who-points-pad"> points)</span>
														</span>
													</span>
													<br>
													<span class="qa-a-item-what">edited</span>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="updated"><span class="value-title" title="2015-11-10T22:47:14+0000"></span>Nov 10, 2015</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span><span class="qa-a-item-who-data"><a href="../../user/Christian+Waluga" class="qa-user-link url nickname">Christian Waluga</a></span>
													</span>
												</span>
											</span>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c8523_list">
												<div class="qa-c-list-item  hentry comment" id="c8589">
													<div class="qa-c-item-content">
														<a name="8589"></a><div class="entry-content"><p>$$\nabla^2 \Phi = 0$$ where $u(x_i, t) = \nabla \Phi$ -- the velocity potential <br>
Boundary condition for wet wall <br>
$$\frac{\partial \Phi}{\partial n} = 0 \quad \forall x_i \in S$$<br>
Boundary condition for a free surface <br>
$$\frac{\partial \Phi}{\partial n} = - \frac{\partial \xi}{\partial t} \quad \forall x_i \in \Sigma$$ where<br>
$\xi (x_2,x_3,t)$ --  a free surface function</p>

<p>Obtaining variational formulation, I would have:<br>
$$\int_Q  \nabla \Phi \nabla v \, \mathrm{d} x - \int_{\Sigma + S} \frac{\partial \Phi}{\partial n} v \, \mathrm{d} S $$</p>

<p>Since only derivative of $\Phi$ is known on wet wall $S$, I could not require $v$ to vanish on $S$, right?</p>

<p>If I can require $v$ to be vanished on $S$, then I would obtain the following form<br>
$$\int_Q  \nabla \Phi \nabla v \, \mathrm{d} x = - \int_\Sigma \frac{\partial \xi}{\partial t} v \, \mathrm{d} S$$</p>

<p>Though for level of $k=1$ or $t=0$ I should have defined $\Phi^0$ and $\xi^0$. If so, then do I need to rearrange all functions at level $k$ to one side and all functions at level $k+1$ to another side in the variational form? If so, to comply with FEniCS methodology, should I transform surface integral to volume integral? </p>

<p>Please advise,<br>
Evgeny.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../8350/potential-flow-of-incompressible-fluid-in-a-reservoir?show=8589#c8589" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-11-17T10:42:13+0000"></span>Nov 17, 2015</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/evgeny-petrov" class="qa-user-link url nickname">evgeny-petrov</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">110</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
																<br>
																<span class="qa-c-item-what">edited</span>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="updated"><span class="value-title" title="2015-11-22T17:08:04+0000"></span>Nov 22, 2015</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span><span class="qa-c-item-who-data"><a href="../../user/evgeny-petrov" class="qa-user-link url nickname">evgeny-petrov</a></span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516468168-9576f9779caeb60d38536bd2349fea0b7dc8cde6">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>