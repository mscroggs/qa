<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>Status of the multistage schemes module, recommended as a way to solve transient problems? - FEniCS Q&amp;A</title>
		<meta name="description" content='I changed this question from asking "*Are there any examples...*" to "*Is it OK  ... 4]: http://fenicsproject.org/documentation/tutorial/timedep.html'>
		<meta name="keywords" content="time-stepping,examples,multistage">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/2813/status-multistage-schemes-recommended-transient-problems">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">Status of the multistage schemes module, recommended as a way to solve transient problems?</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q2813">
								<form method="post" action="../../2813/status-multistage-schemes-recommended-transient-problems">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_2813">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+3<span class="votes-up"><span class="value-title" title="3"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516467945-292c061a47660b8ecc16c5f53e5474fd9334ae82">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../2813/status-multistage-schemes-recommended-transient-problems">
										<div class="qa-q-view-content">
											<a name="2813"></a><div class="entry-content"><p>I changed this question from asking "<em>Are there any examples...</em>" to "<em>Is it OK to use...</em>" as I found the examples for this module once I upgraded to latest version of FEniCS.</p>

<hr>

<p>The <a rel="nofollow" href="http://fenicsproject.org/documentation/dolfin/dev/python/programmers-reference/multistage/">multistage module</a> seems very interesting, it seems to include objects for writing problems using different schemes (such as <a rel="nofollow" href="http://fenicsproject.org/documentation/dolfin/dev/python/programmers-reference/multistage/multistagescheme/index.html">Backwards Euler, Crank-Nicolson, Runge-Kutta</a>) as well as accompanying solvers.</p>

<p><span style="text-decoration: line-through;">Are there any examples out there on how to solve a simple PDE using these tools?</span></p>

<p><a rel="nofollow" href="https://bitbucket.org/fenics-project/dolfin/src/7eb3285868f91811172a90c7e3d4364487cdc483/demo/undocumented/multistage-solver/?at=master">There is a nice example of how to use this to time-step the advection-diffusion equation</a></p>

<p>I am potentially interested in using these to time-step (implicit) non-linear PDEs. The <a rel="nofollow" href="http://fenicsproject.org/documentation/tutorial/timedep.html">native approach to time-stepping</a> is to manually implement the backwards Euler method. But the multistage module seems to take care of most of these details. I just wondering why there is little mention of if in the documentation?</p>

<p>The lack of documentation is normally a sign of an area that is under development. There is also a warning in the source code (example linked above),</p>

<blockquote>
  <p>FIXME: using a MultiStateScheme. It could be removed or changed anytime.</p>
</blockquote>

<p>Does anybody use this interesting module? The status from the documentation seem to imply  <em>"use at your own risk"</em>.</p>

<p>Best wishes,</p>

<p>Dan</p>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/time-stepping" rel="tag" class="qa-tag-link">time-stepping</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/examples" rel="tag" class="qa-tag-link">examples</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/multistage" rel="tag" class="qa-tag-link">multistage</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-avatar">
												<a href="../../user/boyfarrell" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/d0bbd5d01fb8044a8782d537c9b3734c?s=50" width="50" height="50" class="qa-avatar-image" alt=""></a>
											</span>
											<span class="qa-q-view-meta">
												<a href="../../2813/status-multistage-schemes-recommended-transient-problems" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2014-02-24T07:54:29+0000"></span>Feb 24, 2014</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/boyfarrell" class="qa-user-link url nickname">boyfarrell</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">360</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
												<br>
												<span class="qa-q-view-what">edited</span>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="updated"><span class="value-title" title="2014-02-25T00:20:56+0000"></span>Feb 25, 2014</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span><span class="qa-q-view-who-data"><a href="../../user/boyfarrell" class="qa-user-link url nickname">boyfarrell</a></span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c2813_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516467945-9d132f02d18e630fb8e03298918fda30fee8b148">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer answer-selected qa-a-list-item-selected" id="a2825">
									<form method="post" action="../../2813/status-multistage-schemes-recommended-transient-problems">
										<div class="qa-voting qa-voting-net" id="voting_2825">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+1<span class="votes-up"><span class="value-title" title="1"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516467945-292c061a47660b8ecc16c5f53e5474fd9334ae82">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../2813/status-multistage-schemes-recommended-transient-problems">
											<div class="qa-a-item-selected">
												<div class="qa-a-selection">
													<div class="qa-a-selected">&#160;</div>
													<div class="qa-a-selected-text">Best answer</div>
												</div>
												<div class="qa-a-item-content">
													<a name="2825"></a><div class="entry-content"><p>I am the main developer of the multistage scheme code. The main reason it was added was to support vectorized RK solvers for reaction type ODE equations. This is was the <code>PointIntegralSolver</code> should be used for and it is developed right now in a branch on bitbucket. </p>

<p>The <code>MultistageScheme</code> used in the <code>PointIntegralSolver</code> is however general enough to be used in a time integration of more general <code>PDEs</code> (then using the <code>RKSolver</code>), which is illustrated in the demo you link to. Because this part has not been the main focus of my development it has not got the deserved attention, wrt to 1) optimization, 2) application of <code>DirichletBC</code>.</p>

<p>These issues could be addressed by others as the code is not that complex and I welcome anyone to contribute. The most important part for 1), is to add logic for not assembling the <code>Jacobian</code> each time step. For 2) carful care need to be taken to add <code>DirichletBC</code> correctly. Now it is naively added to the stage values (the derivatives), which is clearly wrong (although it seams to work for the demo).</p>
</div>
												</div>
												<span class="qa-a-item-avatar-meta">
													<span class="qa-a-item-avatar">
														<a href="../../user/johanhake" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/73612279d6702974866af2e1a9653a5b?s=40" width="40" height="40" class="qa-avatar-image" alt=""></a>
													</span>
													<span class="qa-a-item-meta">
														<a href="../../2813/status-multistage-schemes-recommended-transient-problems?show=2825#a2825" class="qa-a-item-what">answered</a>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2014-02-25T07:14:23+0000"></span>Feb 25, 2014</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span>
															<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/johanhake" class="qa-user-link url nickname">johanhake</a></span></span>
															<span class="qa-a-item-who-title">FEniCS Expert</span>
															<span class="qa-a-item-who-points">
																<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">22,480</span><span class="qa-a-item-who-points-pad"> points)</span>
															</span>
														</span>
														<br>
														<span class="qa-a-item-what">selected</span>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="updated"><span class="value-title" title="2014-02-25T08:53:17+0000"></span>Feb 25, 2014</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span><span class="qa-a-item-who-data"><a href="../../user/boyfarrell" class="qa-user-link url nickname">boyfarrell</a></span>
														</span>
													</span>
												</span>
											</div>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c2825_list">
												<div class="qa-c-list-item  hentry comment" id="c2827">
													<div class="qa-c-item-content">
														<a name="2827"></a><div class="entry-content"><p>Thank you for your comment, it is really a interesting area of study. At the moment I am just starting to explore FEniCS by constructing some toy problems, but ultimately I am interested in using to do real work time stepping some reasonably complicated problems. If I build up some experience in this area then I would be happy to contribute, but right now I pretty much a FEniCS novice.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-avatar">
																<a href="../../user/boyfarrell" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/d0bbd5d01fb8044a8782d537c9b3734c?s=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
															</span>
															<span class="qa-c-item-meta">
																<a href="../../2813/status-multistage-schemes-recommended-transient-problems?show=2827#c2827" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-02-25T08:53:12+0000"></span>Feb 25, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/boyfarrell" class="qa-user-link url nickname">boyfarrell</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">360</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c2829">
													<div class="qa-c-item-content">
														<a name="2829"></a><div class="entry-content"><p>What Dirichlet boundary conditions are to be applied to the stages in RK is indeed a topic of research (see <a rel="nofollow" href="http://epubs.siam.org/doi/abs/10.1137/S1064827594273948">http://epubs.siam.org/doi/abs/10.1137/S1064827594273948</a> for example), but when the values are not time-dependent, you can't make a mistake.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-avatar">
																<a href="../../user/nschloe" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/500a1e2e864ae08f386afde2cd21add0?s=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
															</span>
															<span class="qa-c-item-meta">
																<a href="../../2813/status-multistage-schemes-recommended-transient-problems?show=2829#c2829" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-02-25T10:25:30+0000"></span>Feb 25, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/nschloe" class="qa-user-link url nickname">nschloe</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">7,120</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c2833">
													<div class="qa-c-item-content">
														<a name="2833"></a><div class="entry-content"><p>Thanks for clarifying this Nico. The <code>DirichletBC</code> used in the demo is indeed time dependent.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-avatar">
																<a href="../../user/johanhake" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/73612279d6702974866af2e1a9653a5b?s=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
															</span>
															<span class="qa-c-item-meta">
																<a href="../../2813/status-multistage-schemes-recommended-transient-problems?show=2833#c2833" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-02-25T12:33:00+0000"></span>Feb 25, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/johanhake" class="qa-user-link url nickname">johanhake</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Expert</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">22,480</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c11232">
													<div class="qa-c-item-content">
														<a name="11232"></a><div class="entry-content"><p>Does this module work with Discontinuous Galerkin methods? It seems that the right hand side form can only have one integral.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../2813/status-multistage-schemes-recommended-transient-problems?show=11232#c11232" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2016-09-27T21:19:16+0000"></span>Sep 27, 2016</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/miguelito" class="qa-user-link url nickname">miguelito</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">760</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516467945-a761f209fc09b86d1000b23fd9e3ea94c97c972e">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>