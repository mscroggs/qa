<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>Approximating schur complements for saddle-point systems - FEniCS Q&amp;A</title>
		<meta name="description" content="If I am doing a simple mixed-poisson example using RT0 spaces, I would like to do ... : http://firedrakeproject.org/demos/saddle_point_systems.py.html">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/8905/approximating-schur-complements-for-saddle-point-systems">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">Approximating schur complements for saddle-point systems</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q8905">
								<form method="post" action="../../8905/approximating-schur-complements-for-saddle-point-systems">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_8905">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+1<span class="votes-up"><span class="value-title" title="1"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516468198-79b236be79fd778e283a69ea37a62c4bbe36fbea">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../8905/approximating-schur-complements-for-saddle-point-systems">
										<div class="qa-q-view-content">
											<a name="8905"></a><div class="entry-content"><p>If I am doing a simple mixed-poisson example using RT0 spaces, I would like to do a schur-complement approximation for preconditioning.</p>

<p>PETSc has interfaces for this, and one could simply have these options passed in:</p>

<p>-ksp_type gmres<br>
-pc_type fieldsplit<br>
-pc_fieldsplit_type schur<br>
-pc_fieldsplit_schur_fact_type full<br>
-pc_fieldsplit_schur_precondition selfp<br>
-fieldsplit_0_ksp_type preonly<br>
-fieldsplit_0_pc_type bjacobi<br>
-fieldsplit_0_sub_pc_type ilu<br>
-fieldsplit_1_ksp_type preonly<br>
-fieldsplit_1_pc_type hypre</p>

<p>Where "selfp" happens to be the approximation of the laplacian, but of course one could pass in their own form. In the <a rel="nofollow" href="http://firedrakeproject.org/demos/saddle_point_systems.py.html">Firedrake project</a>, one could do these easily, but I was wondering if FEniCS could do something similar?</p>

<p>Thanks,<br>
Justin</p>
</div>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../8905/approximating-schur-complements-for-saddle-point-systems" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2015-12-21T05:00:31+0000"></span>Dec 21, 2015</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/jychang48" class="qa-user-link url nickname">jychang48</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">510</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c8905_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516468198-fcc2c82d140f1984e77cddc5d2247997eafc8b70">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer" id="a8906">
									<form method="post" action="../../8905/approximating-schur-complements-for-saddle-point-systems">
										<div class="qa-voting qa-voting-net" id="voting_8906">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+1<span class="votes-up"><span class="value-title" title="1"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516468198-79b236be79fd778e283a69ea37a62c4bbe36fbea">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../8905/approximating-schur-complements-for-saddle-point-systems">
											<div class="qa-a-selection">
											</div>
											<div class="qa-a-item-content">
												<a name="8906"></a><div class="entry-content"><p>Have a look at the stokes-iterative<br>
demo to see how to submit a separate form for the <br>
preconditioner</p>
</div>
											</div>
											<span class="qa-a-item-avatar-meta">
												<span class="qa-a-item-meta">
													<a href="../../8905/approximating-schur-complements-for-saddle-point-systems?show=8906#a8906" class="qa-a-item-what">answered</a>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2015-12-21T13:02:19+0000"></span>Dec 21, 2015</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span>
														<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/Kent-Andre+Mardal" class="qa-user-link url nickname">Kent-Andre Mardal</a></span></span>
														<span class="qa-a-item-who-title">FEniCS Expert</span>
														<span class="qa-a-item-who-points">
															<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">14,380</span><span class="qa-a-item-who-points-pad"> points)</span>
														</span>
													</span>
												</span>
											</span>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c8906_list">
												<div class="qa-c-list-item  hentry comment" id="c8952">
													<div class="qa-c-item-content">
														<a name="8952"></a><div class="entry-content"><p>Thanks for your answer. However, my question is more on the possibility of explicitly doing some form of schur complementing instead of submitting a separate form for the preconditioner. Because AFAIK, it seems FEniCS only provides block diagonal preconditioning where one provides the forms for the top left and bottom right diagonals, and such preconditioning does not work well for the mixed-poisson problem.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../8905/approximating-schur-complements-for-saddle-point-systems?show=8952#c8952" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2015-12-31T18:03:32+0000"></span>Dec 31, 2015</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/jychang48" class="qa-user-link url nickname">jychang48</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">510</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c8955">
													<div class="qa-c-item-content">
														<a name="8955"></a><div class="entry-content"><p>To work with the explicit form of the Schur complement you would need<br>
to use the PETSc backend. You may do this with petsc4py if you<br>
want to work in Python. </p>

<p>The module cbc.block, <br>
<a rel="nofollow" href="https://bitbucket.org/fenics-apps/cbc.block,">https://bitbucket.org/fenics-apps/cbc.block,</a><br>
which is a tool using petsc4py, also <br>
has some tools for constructing the preconditioner in more <br>
explicit forms. </p>

<p>However, you should also know that for the mixed-poisson problem <br>
you may construct spectrally equivalent forms using the jump terms<br>
instead of the Schur complement. </p>

<p>See, Rusten, Vassilevski, Winther, Math Comp., 1996<br>
<a rel="nofollow" href="http://www.ams.org/journals/mcom/1996-65-214/S0025-5718-96-00720-X/S0025-5718-96-00720-X.pdf">http://www.ams.org/journals/mcom/1996-65-214/S0025-5718-96-00720-X/S0025-5718-96-00720-X.pdf</a><br>
and Mardal, Winther, NLAA, 2011<br>
<a rel="nofollow" href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.154.9307&amp;rep=rep1&amp;type=pdf">http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.154.9307&amp;rep=rep1&amp;type=pdf</a></p>

<p>I thought that we had this example as one of the examples in bc.block, but it is not. <br>
I will put in an example of this today. </p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../8905/approximating-schur-complements-for-saddle-point-systems?show=8955#c8955" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2016-01-01T10:46:07+0000"></span>Jan 1, 2016</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Kent-Andre+Mardal" class="qa-user-link url nickname">Kent-Andre Mardal</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Expert</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">14,380</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c8956">
													<div class="qa-c-item-content">
														<a name="8956"></a><div class="entry-content"><p>I've added two demos to cbc.block now. </p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../8905/approximating-schur-complements-for-saddle-point-systems?show=8956#c8956" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2016-01-01T13:09:00+0000"></span>Jan 1, 2016</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Kent-Andre+Mardal" class="qa-user-link url nickname">Kent-Andre Mardal</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Expert</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">14,380</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516468198-e49fed316e786dd3595b491b455ae50756dfb99c">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>