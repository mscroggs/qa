<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>evaluation of function at mesh coordinates - FEniCS Q&amp;A</title>
		<meta name="description" content="In Section 1.6 of the FEniCS book, there is a comparison between the calculated value  ... /interpolate-function-given-matrix-on-finite-element-basis">
		<meta name="keywords" content="expression,function,coordinates">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/493/evaluation-of-function-at-mesh-coordinates">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">evaluation of function at mesh coordinates</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q493">
								<form method="post" action="../../493/evaluation-of-function-at-mesh-coordinates">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_493">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+1<span class="votes-up"><span class="value-title" title="2"></span></span><span class="votes-down"><span class="value-title" title="1"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516468019-7c3c0f8c36e6283519fef88eba9005d538b71f77">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../493/evaluation-of-function-at-mesh-coordinates">
										<div class="qa-q-view-content">
											<a name="493"></a><div class="entry-content"><p>In Section 1.6 of the FEniCS book, there is a comparison between the calculated value <code>u</code> and the exact solution <code>u0</code>. In particular <code>u0(coor[i])</code> returns the value of u0 at vertex with global number i.</p>

<p>If</p>

<pre><code>V = FunctionSpace(mesh, 'Lagrange', 1)
u = Function(V)
</code></pre>

<p>why is</p>

<pre><code>u.vector().array()[i] != u(mesh.coordinates()[i])?
</code></pre>

<p>From running an example I see that the values are permuted.</p>

<p>And does</p>

<pre><code>u0(mesh.coordinates()[i])
</code></pre>

<p>gives the correctly ordered result because <code>u0</code> is an <code>Expression</code>?</p>

<p>Is this related to the ordering of the degrees of freedom as in <a rel="nofollow" href="http://fenicsproject.org/qa/207/how-to-interpolate-data-at-vertices-of-3d-cells"></a><a rel="nofollow" href="http://fenicsproject.org/qa/207/how-to-interpolate-data-at-vertices-of-3d-cells">http://fenicsproject.org/qa/207/how-to-interpolate-data-at-vertices-of-3d-cells</a><br>
<a rel="nofollow" href="http://fenicsproject.org/qa/465/interpolate-function-given-matrix-on-finite-element-basis"></a><a rel="nofollow" href="http://fenicsproject.org/qa/465/interpolate-function-given-matrix-on-finite-element-basis">http://fenicsproject.org/qa/465/interpolate-function-given-matrix-on-finite-element-basis</a>?</p>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/expression" rel="tag" class="qa-tag-link">expression</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/function" rel="tag" class="qa-tag-link">function</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/coordinates" rel="tag" class="qa-tag-link">coordinates</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../493/evaluation-of-function-at-mesh-coordinates" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2013-07-11T08:33:00+0000"></span>Jul 11, 2013</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/michele.zaffalon" class="qa-user-link url nickname">michele.zaffalon</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">450</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
												<br>
												<span class="qa-q-view-what">edited</span>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="updated"><span class="value-title" title="2013-07-11T09:37:09+0000"></span>Jul 11, 2013</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span><span class="qa-q-view-who-data"><a href="../../user/michele.zaffalon" class="qa-user-link url nickname">michele.zaffalon</a></span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" id="c493_list">
											<div class="qa-c-list-item  hentry comment" id="c495">
												<div class="qa-c-item-content">
													<a name="495"></a><div class="entry-content"><p>As you have seen from the two linked questions you provide, the ordering of dofs no longer coincides with the vertices. This is the explanation for why you get different answers with DOLFIN version 1.1 and larger compared to DOLFIN 1.0, which the book example uses. Also could you please rephrase your question to a proper question? Right now it is an observation.</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-avatar">
															<a href="../../user/johanhake" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/73612279d6702974866af2e1a9653a5b?s=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
														</span>
														<span class="qa-c-item-meta">
															<a href="../../493/evaluation-of-function-at-mesh-coordinates?show=495#c495" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2013-07-11T09:07:01+0000"></span>Jul 11, 2013</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/johanhake" class="qa-user-link url nickname">johanhake</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Expert</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">22,480</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c496">
												<div class="qa-c-item-content">
													<a name="496"></a><div class="entry-content"><p>Do you mean that</p>

<pre><code>u(mesh.coordinates()[i])
</code></pre>

<p>is the correct approach?</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../493/evaluation-of-function-at-mesh-coordinates?show=496#c496" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2013-07-11T09:40:30+0000"></span>Jul 11, 2013</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/michele.zaffalon" class="qa-user-link url nickname">michele.zaffalon</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Novice</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">450</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
															<br>
															<span class="qa-c-item-what">edited</span>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="updated"><span class="value-title" title="2013-07-11T12:40:56+0000"></span>Jul 11, 2013</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span><span class="qa-c-item-who-data"><a href="../../user/michele.zaffalon" class="qa-user-link url nickname">michele.zaffalon</a></span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c497">
												<div class="qa-c-item-content">
													<a name="497"></a><div class="entry-content"><blockquote>
  <p>why is<br>
      u.vector().array()[i] != u(mesh.coordinates()[i])?</p>
</blockquote>

<p>The left hand side picks the ith degree of freedom, and the right hand side evaluates the <code>Function</code> at coordinate i. These are not the same as the linked questions mentions.</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-avatar">
															<a href="../../user/johanhake" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/73612279d6702974866af2e1a9653a5b?s=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
														</span>
														<span class="qa-c-item-meta">
															<a href="../../493/evaluation-of-function-at-mesh-coordinates?show=497#c497" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2013-07-11T09:51:25+0000"></span>Jul 11, 2013</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/johanhake" class="qa-user-link url nickname">johanhake</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Expert</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">22,480</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c499">
												<div class="qa-c-item-content">
													<a name="499"></a><div class="entry-content"><p>Wouldn't it be best to mention this change between DOLFIN version &gt;=1.1 and 1.0 in the tutorial?</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../493/evaluation-of-function-at-mesh-coordinates?show=499#c499" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2013-07-11T12:43:00+0000"></span>Jul 11, 2013</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/michele.zaffalon" class="qa-user-link url nickname">michele.zaffalon</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Novice</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">450</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c532">
												<div class="qa-c-item-content">
													<a name="532"></a><div class="entry-content"><p>Certainly it would. It is also missing in <a rel="nofollow" href="http://fenicsproject.org/releases/1.1/index.html">1.1 release notes</a>. You could file a bug to <a rel="nofollow" href="https://bitbucket.org/fenics-project/fenics-web/issues/new">FEniCS web</a> and possibly also <a rel="nofollow" href="https://bitbucket.org/fenics-project/fenics-book/issues/new">FEniCS book</a> as some manuals are generated by its source.</p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-avatar">
															<a href="../../user/Jan+Blechta" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/dc6f8dce77e4a0bd5adc7ff31ab83741?s=20" width="20" height="20" class="qa-avatar-image" alt=""></a>
														</span>
														<span class="qa-c-item-meta">
															<a href="../../493/evaluation-of-function-at-mesh-coordinates?show=532#c532" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2013-07-12T14:38:36+0000"></span>Jul 12, 2013</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Jan+Blechta" class="qa-user-link url nickname">Jan Blechta</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Expert</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">51,420</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
											<div class="qa-c-list-item  hentry comment" id="c546">
												<div class="qa-c-item-content">
													<a name="546"></a><div class="entry-content"><p>Filed here <br>
<a rel="nofollow" href="https://bitbucket.org/fenics-project/fenics-web/issue/4/tutorial-not-up-to-date-with-release-11">https://bitbucket.org/fenics-project/fenics-web/issue/4/tutorial-not-up-to-date-with-release-11</a> <br>
and here <br>
<a rel="nofollow" href="https://bitbucket.org/fenics-project/fenics-book/issue/15/tutorial-not-up-to-date-with-release-11">https://bitbucket.org/fenics-project/fenics-book/issue/15/tutorial-not-up-to-date-with-release-11</a></p>
</div>
												</div>
												<div class="qa-c-item-footer">
													<span class="qa-c-item-avatar-meta">
														<span class="qa-c-item-meta">
															<a href="../../493/evaluation-of-function-at-mesh-coordinates?show=546#c546" class="qa-c-item-what">commented</a>
															<span class="qa-c-item-when">
																<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2013-07-12T21:28:05+0000"></span>Jul 12, 2013</span></span>
															</span>
															<span class="qa-c-item-who">
																<span class="qa-c-item-who-pad">by </span>
																<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/michele.zaffalon" class="qa-user-link url nickname">michele.zaffalon</a></span></span>
																<span class="qa-c-item-who-title">FEniCS Novice</span>
																<span class="qa-c-item-who-points">
																	<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">450</span><span class="qa-c-item-who-points-pad"> points)</span>
																</span>
															</span>
														</span>
													</span>
													<div class="qa-c-item-buttons">
													</div>
												</div>
												<div class="qa-c-item-clear">
												</div>
											</div> <!-- END qa-c-item -->
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516468019-9c35b30c43c2e335c88680a8e4e1b5007f271fd4">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title" style="display:none;"></h2>
							<div class="qa-a-list" id="a_list">
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>