<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>Aligning Mesh to internal boundarys - FEniCS Q&amp;A</title>
		<meta name="description" content="Hello everyone, I have the following problem: I have a rectangle domain, lets say $$ [0,R]x[0,2* ...  inside of the domain. Thank you for your help :)">
		<meta name="keywords" content="mesh,internal,boundary">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/3479/aligning-mesh-to-internal-boundarys">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">Aligning Mesh to internal boundarys</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q3479">
								<form method="post" action="../../3479/aligning-mesh-to-internal-boundarys">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_3479">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+1<span class="votes-up"><span class="value-title" title="1"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> vote</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516467972-e72d28f7055e0d9e8b9409f7a8eaa0fc62369550">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../3479/aligning-mesh-to-internal-boundarys">
										<div class="qa-q-view-content">
											<a name="3479"></a><div class="entry-content"><p>Hello everyone,</p>

<p>I have the following problem: I have a rectangle domain, lets say<br>
$$ [0,R]x[0,2*\pi] $$ resulting from some simulation in polar coordinates. I can use the standard RectangleMesh routine to get a first, regular mesh for this domain. <br>
Additionally I have two internal boundaries, e.g. at $$r = r_1$$ and $$r = r_2.$$ These internal boundaries are always shaped like that (so very simple, just r = const), but in general the regular mesh doesn't coincide with these internal boundaries. <br>
What is the best way to change the regular mesh, so that I will get a new mesh with some triangles stretched or moved and having the mesh aligned with the boundaries?<br>
My current implementation is to look for the nearest vertices to the boundary and move them, so that they lie on the $$r = r_i$$ lines, but I think in special cases this can lead to a very unregular and bad mesh. The snap_boundary method didn't work. I think the reason is, that the boundaries are in the inside of the domain.</p>

<p>Thank you for your help :)</p>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/mesh" rel="tag" class="qa-tag-link">mesh</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/internal" rel="tag" class="qa-tag-link">internal</a></li>
												<li class="qa-q-view-tag-item"><a href="../../tag/boundary" rel="tag" class="qa-tag-link">boundary</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../3479/aligning-mesh-to-internal-boundarys" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2014-05-05T21:24:03+0000"></span>May 5, 2014</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/soply" class="qa-user-link url nickname">soply</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">400</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c3479_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516467972-3a0230d096787be0e20673e7eb9cae86e4bcca47">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer" id="a3483">
									<form method="post" action="../../3479/aligning-mesh-to-internal-boundarys">
										<div class="qa-voting qa-voting-net" id="voting_3483">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+2<span class="votes-up"><span class="value-title" title="2"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516467972-e72d28f7055e0d9e8b9409f7a8eaa0fc62369550">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../3479/aligning-mesh-to-internal-boundarys">
											<div class="qa-a-selection">
											</div>
											<div class="qa-a-item-content">
												<a name="3483"></a><div class="entry-content"><p>I think you are on the right track with finding the closest vertices, but you have to move all of the nodes, i.e. to satisfy the first boundary, you find the vertices below r1 and add <br>
r*dr/max(r1),<br>
where dr is the maximum distance to move in the r-direction (for the closest vertices) and max(r1) is the r value for these close vertices.</p>

<p>The alternative is to stitch together three rectangular meshes.</p>

<p>I guess the general answer is to use a mesh generator with a geometry engine, such as gmesh.</p>
</div>
											</div>
											<span class="qa-a-item-avatar-meta">
												<span class="qa-a-item-avatar">
													<a href="../../user/KristianE" class="qa-avatar-link"><img src="https://www.gravatar.com/avatar/8e8c30d82e263e44bd8fe50055a60421?s=40" width="40" height="40" class="qa-avatar-image" alt=""></a>
												</span>
												<span class="qa-a-item-meta">
													<a href="../../3479/aligning-mesh-to-internal-boundarys?show=3483#a3483" class="qa-a-item-what">answered</a>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2014-05-06T15:23:21+0000"></span>May 6, 2014</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span>
														<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/KristianE" class="qa-user-link url nickname">KristianE</a></span></span>
														<span class="qa-a-item-who-title">FEniCS Expert</span>
														<span class="qa-a-item-who-points">
															<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">12,900</span><span class="qa-a-item-who-points-pad"> points)</span>
														</span>
													</span>
												</span>
											</span>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c3483_list">
												<div class="qa-c-list-item  hentry comment" id="c3500">
													<div class="qa-c-item-content">
														<a name="3500"></a><div class="entry-content"><p>Hi, <br>
yes you are right, I could avoid having bad meshes with this method. I think I will change my implementation in that way, but I hoped there was a simple method or something like that like snap_boundarys but for internal subdomains. <br>
Is there a method in fenics for stitching together different meshes? I didn't found one, but that would make everything very easy, because I could just use 3 RectangleMeshes and use some method which merges the meshes.</p>

<p>Thanks for your help!</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../3479/aligning-mesh-to-internal-boundarys?show=3500#c3500" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-05-08T12:48:48+0000"></span>May 8, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/soply" class="qa-user-link url nickname">soply</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">400</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516467972-285a95e4d76d336d07e57520e28246d9d8a44548">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>