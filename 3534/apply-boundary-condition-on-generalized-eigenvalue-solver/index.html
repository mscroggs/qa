<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>apply boundary condition on a generalized eigenvalue solver - FEniCS Q&amp;A</title>
		<meta name="description" content="Is there a simple way to apply boundary condition on a generalized eigenvalue solver? Here is  ... down_cast(M) eigensolver = SLEPcEigenSolver(C1s, M)">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/3534/apply-boundary-condition-on-generalized-eigenvalue-solver">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">apply boundary condition on a generalized eigenvalue solver</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q3534">
								<form method="post" action="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_3534">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+2<span class="votes-up"><span class="value-title" title="2"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516467975-f59607381939c9e3361a4abf6c85f390dcd4c242">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver">
										<div class="qa-q-view-content">
											<a name="3534"></a><div class="entry-content"><p>Is there a simple way to apply boundary condition on a generalized eigenvalue solver?</p>

<p>Here is what I did to apply a zero dirichlet boundary condition on a generalized eigenvalue solver:</p>

<pre><code>u0 = Constant(0.0)
bc = DirichletBC(V, u0, boundary)
u = TrialFunction(V)
v = TestFunction(V)

c1s=0.5*inner(nabla_grad(u),nabla_grad(v))*dx+u*v2s*v*dx-u*v_ext_corr*v*dx
m=u*v*dx
b=v*dx

C1s, _ = assemble_system(c1s, b, bc)
M, _ = assemble_system(m, b, bc)
bc.zero(M)
C1s = down_cast(C1s)
M = down_cast(M)
eigensolver = SLEPcEigenSolver(C1s, M)
</code></pre>
</div>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2014-05-14T00:32:52+0000"></span>May 14, 2014</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/vincehouhou" class="qa-user-link url nickname">vincehouhou</a></span></span>
													<span class="qa-q-view-who-title">FEniCS Novice</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">540</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c3534_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516467975-e38a80c8eee68ac91a7d6ae3212c162ef5a55171">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer" id="a3557">
									<form method="post" action="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver">
										<div class="qa-voting qa-voting-net" id="voting_3557">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516467975-f59607381939c9e3361a4abf6c85f390dcd4c242">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver">
											<div class="qa-a-selection">
											</div>
											<div class="qa-a-item-content">
												<a name="3557"></a><div class="entry-content"><p>Don't use assemble_system in this case, but just assemble and apply the boundary conditions yourself, i.e.</p>

<pre><code>u0 = Constant(0.0)
bc = DirichletBC(V, u0, boundary)
u = TrialFunction(V)
v = TestFunction(V)

c1s=0.5*inner(nabla_grad(u),nabla_grad(v))*dx+u*v2s*v*dx-u*v_ext_corr*v*dx
m=u*v*dx

C1s = PETScMatrix()
assemble(c1s, tensor=C1s)
bc.apply(C1s)

M = PETScMatrix()
assemble(m, tensor=M)
bc.zero(M)

eigensolver = SLEPcEigenSolver(C1s, M)
</code></pre>

<p>Also have a look at the <a rel="nofollow" href="http://fenicsproject.org/documentation/dolfin/1.3.0/python/demo/documented/eigenvalue/python/documentation.html">eigensolver tutorial</a> shipping with fenics:</p>
</div>
											</div>
											<span class="qa-a-item-avatar-meta">
												<span class="qa-a-item-meta">
													<a href="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver?show=3557#a3557" class="qa-a-item-what">answered</a>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2014-05-15T09:54:01+0000"></span>May 15, 2014</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span>
														<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/cevito" class="qa-user-link url nickname">cevito</a></span></span>
														<span class="qa-a-item-who-title">FEniCS User</span>
														<span class="qa-a-item-who-points">
															<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">5,550</span><span class="qa-a-item-who-points-pad"> points)</span>
														</span>
													</span>
													<br>
													<span class="qa-a-item-what">edited</span>
													<span class="qa-a-item-when">
														<span class="qa-a-item-when-data"><span class="updated"><span class="value-title" title="2014-05-27T09:05:10+0000"></span>May 27, 2014</span></span>
													</span>
													<span class="qa-a-item-who">
														<span class="qa-a-item-who-pad">by </span><span class="qa-a-item-who-data"><a href="../../user/cevito" class="qa-user-link url nickname">cevito</a></span>
													</span>
												</span>
											</span>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c3557_list">
												<div class="qa-c-list-item  hentry comment" id="c3663">
													<div class="qa-c-item-content">
														<a name="3663"></a><div class="entry-content"><p>By the method you suggested, the boundary value of the eigenvector calculated is not  zero strictly. By my method, the boundary value of the eigenvector calculated is zero strictly. The eigenvalues by these two methods has a little bit difference. How do you think about it?</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver?show=3663#c3663" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-05-27T06:13:02+0000"></span>May 27, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/vincehouhou" class="qa-user-link url nickname">vincehouhou</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">540</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c3664">
													<div class="qa-c-item-content">
														<a name="3664"></a><div class="entry-content"><p>And if the eigenvalue is 1, your method will not give zero boundary condition.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver?show=3664#c3664" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-05-27T06:43:44+0000"></span>May 27, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/vincehouhou" class="qa-user-link url nickname">vincehouhou</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">540</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c3665">
													<div class="qa-c-item-content">
														<a name="3665"></a><div class="entry-content"><p>In order to make the boundary condition as zero exactly. </p>

<p>Based on your method, I use "bc.zero(M)" instead of "bc.apply(M)".</p>

<p>Then I get exactly same results as my code.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver?show=3665#c3665" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-05-27T07:29:48+0000"></span>May 27, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/vincehouhou" class="qa-user-link url nickname">vincehouhou</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">540</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c3666">
													<div class="qa-c-item-content">
														<a name="3666"></a><div class="entry-content"><p>If I want to apply non-zero dirichlet boundary condition, what should I do?</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver?show=3666#c3666" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-05-27T07:31:43+0000"></span>May 27, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/vincehouhou" class="qa-user-link url nickname">vincehouhou</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">540</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c3667">
													<div class="qa-c-item-content">
														<a name="3667"></a><div class="entry-content"><p>You're correct, this should be bc.zero(M). Note, that, in general, you can't set arbitrary non-zero dirichlet boundary condition in case of an eigenvalue problem as this problem is overdetermined.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver?show=3667#c3667" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-05-27T09:05:48+0000"></span>May 27, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/cevito" class="qa-user-link url nickname">cevito</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">5,550</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
																<br>
																<span class="qa-c-item-what">edited</span>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="updated"><span class="value-title" title="2014-05-27T09:12:07+0000"></span>May 27, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span><span class="qa-c-item-who-data"><a href="../../user/cevito" class="qa-user-link url nickname">cevito</a></span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c3675">
													<div class="qa-c-item-content">
														<a name="3675"></a><div class="entry-content"><p>Thanks for your reply.</p>

<ol>
<li><p>Why will this problem be overdetermined if we set arbitrary non-zero dirichlet boundary condition?</p></li>
<li><p>After I set the zero-boundary condition, sometimes I will meet such error:</p></li>
</ol>

<p>Computing eigenvalues. This can take a minute.<br>
[0]PETSC ERROR: --------------------- Error Message ------------------------------------<br>
[0]PETSC ERROR: Detected zero pivot in LU factorization<br>
see <a rel="nofollow" href="http://www.mcs.anl.gov/petsc/petsc-as/documentation/faq.html#ZeroPivot!">http://www.mcs.anl.gov/petsc/petsc-as/documentation/faq.html#ZeroPivot!</a><br>
[0]PETSC ERROR: Zero pivot row 0 value 0 tolerance 1e-12!<br>
[0]PETSC ERROR: ------------------------------------------------------------------------<br>
[0]PETSC ERROR: Petsc Release Version 3.2.0, Patch 5, Sat Oct 29 13:45:54 CDT 2011 <br>
[0]PETSC ERROR: See docs/changes/index.html for recent updates.<br>
[0]PETSC ERROR: See docs/faq.html for hints about trouble shooting.<br>
[0]PETSC ERROR: See docs/index.html for manual pages.<br>
[0]PETSC ERROR: ------------------------------------------------------------------------<br>
[0]PETSC ERROR: Unknown Name on a linux-gnu named vincehouhou-ThinkPad-X230 by vincehouhou Tue May 27 10:44:06 2014<br>
[0]PETSC ERROR: Libraries linked from /build/buildd/petsc-3.2.dfsg/linux-gnu-c-opt/lib<br>
[0]PETSC ERROR: Configure run at Tue Jun 12 21:14:38 2012<br>
[0]PETSC ERROR: Configure options --with-shared-libraries --with-debugging=0 --useThreads 0 --with-clanguage=C++ --with-c-support --with-fortran-interfaces=1 --with-mpi-dir=/usr/lib/openmpi --with-mpi-shared=1 --with-blas-lib=-lblas --with-lapack-lib=-llapack --with-blacs=1 --with-blacs-include=/usr/include --with-blacs-lib="[/usr/lib/libblacsCinit-openmpi.so,/usr/lib/libblacs-openmpi.so]" --with-scalapack=1 --with-scalapack-include=/usr/include --with-scalapack-lib=/usr/lib/libscalapack-openmpi.so --with-mumps=1 --with-mumps-include=/usr/include --with-mumps-lib="[/usr/lib/libdmumps.so,/usr/lib/libzmumps.so,/usr/lib/libsmumps.so,/usr/lib/libcmumps.so,/usr/lib/libmumps_common.so,/usr/lib/libpord.so]" --with-umfpack=1 --with-umfpack-include=/usr/include/suitesparse --with-umfpack-lib="[/usr/lib/libumfpack.so,/usr/lib/libamd.so]" --with-cholmod=1 --with-cholmod-include=/usr/include/suitesparse --with-cholmod-lib=/usr/lib/libcholmod.so --with-spooles=1 --with-spooles-include=/usr/include/spooles --with-spooles-lib=/usr/lib/libspooles.so --with-hypre=1 --with-hypre-dir=/usr --with-ptscotch=1 --with-ptscotch-include=/usr/include/scotch --with-ptscotch-lib="[/usr/lib/libptesmumps.so,/usr/lib/libptscotch.so,/usr/lib/libptscotcherr.so]" --with-hdf5=1 --with-hdf5-dir=/usr<br>
[0]PETSC ERROR: ------------------------------------------------------------------------<br>
[0]PETSC ERROR: MatPivotCheck_none() line 499 in src/mat/impls/aij/seq//build/buildd/petsc-3.2.dfsg/include/private/matimpl.h<br>
[0]PETSC ERROR: MatPivotCheck() line 518 in src/mat/impls/aij/seq//build/buildd/petsc-3.2.dfsg/include/private/matimpl.h<br>
[0]PETSC ERROR: MatLUFactorNumeric_SeqAIJ() line 565 in src/mat/impls/aij/seq/aijfact.c<br>
[0]PETSC ERROR: MatLUFactorNumeric() line 2876 in src/mat/interface/matrix.c<br>
[0]PETSC ERROR: PCSetUp_LU() line 160 in src/ksp/pc/impls/factor/lu/lu.c<br>
[0]PETSC ERROR: PCSetUp() line 819 in src/ksp/pc/interface/precon.c<br>
[0]PETSC ERROR: KSPSetUp() line 260 in src/ksp/ksp/interface/itfunc.c<br>
[0]PETSC ERROR: PCSetUp_Redundant() line 176 in src/ksp/pc/impls/redundant/redundant.c<br>
[0]PETSC ERROR: PCSetUp() line 819 in src/ksp/pc/interface/precon.c<br>
[0]PETSC ERROR: KSPSetUp() line 260 in src/ksp/ksp/interface/itfunc.c<br>
[0]PETSC ERROR: STSetUp_Shift() line 94 in src/st/impls/shift/shift.c<br>
[0]PETSC ERROR: STSetUp() line 269 in src/st/interface/stsolve.c<br>
[0]PETSC ERROR: EPSSetUp() line 155 in src/eps/interface/setup.c<br>
[0]PETSC ERROR: EPSSolve() line 122 in src/eps/interface/solve.c<br>
Traceback (most recent call last):<br>
  File "har1D_test.py", line 98, in <br>
    r, c, rx, cx = eigensolver.get_eigenpair(0)<br>
  File "/usr/lib/python2.7/dist-packages/dolfin/cpp.py", line 5436, in get_eigenpair<br>
    lr, lc = self._get_eigenpair(r_vec, c_vec, i)<br>
RuntimeError: </p>

<p>*** -------------------------------------------------------------------------<br>
*** DOLFIN encountered an error. If you are not able to resolve this issue<br>
*** using the information listed below, you can ask for help at</p>

<hr>

<p>***     <a rel="nofollow" href="https://answers.launchpad.net/dolfin">https://answers.launchpad.net/dolfin</a></p>

<hr>

<p>*** Remember to include the error message listed below and, if possible,<br>
*** include a <em>minimal</em> running example to reproduce the error.</p>

<hr>

<p>*** -------------------------------------------------------------------------<br>
*** Error:  Unable to extract eigenpair from SLEPc eigenvalue solver.<br>
*** Reason: Requested eigenpair (0) has not been computed.<br>
*** Where:  This error was encountered inside SLEPcEigenSolver.cpp.<br>
*** -------------------------------------------------------------------------</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver?show=3675#c3675" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-05-27T17:47:24+0000"></span>May 27, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/vincehouhou" class="qa-user-link url nickname">vincehouhou</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">540</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c3677">
													<div class="qa-c-item-content">
														<a name="3677"></a><div class="entry-content"><p>If we set "bc.zero(M)", M should be always singular. </p>

<p>Should "Detected zero pivot in LU factorization" error be usual? How should we handle this.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver?show=3677#c3677" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-05-27T17:51:50+0000"></span>May 27, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/vincehouhou" class="qa-user-link url nickname">vincehouhou</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS Novice</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">540</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c6216">
													<div class="qa-c-item-content">
														<a name="6216"></a><div class="entry-content"><p>I face the same problem of zero pivot. Did you find a solution ?</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver?show=6216#c6216" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-12-16T14:01:19+0000"></span>Dec 16, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/praveen" class="qa-user-link url nickname">praveen</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">2,760</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c6218">
													<div class="qa-c-item-content">
														<a name="6218"></a><div class="entry-content"><p>Try to use shift-invert, i.e.,</p>

<pre><code>eigensolver.parameters["spectrum"] = "target magnitude"
eigensolver.parameters["spectral_transform"] = "shift-and-invert"
eigensolver.parameters["spectral_shift"] = &lt;insert_value_for_shift&gt;
</code></pre>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver?show=6218#c6218" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-12-17T08:47:20+0000"></span>Dec 17, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/cevito" class="qa-user-link url nickname">cevito</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">5,550</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
												<div class="qa-c-list-item  hentry comment" id="c6220">
													<div class="qa-c-item-content">
														<a name="6220"></a><div class="entry-content"><p>Hello cevito, even with these options I get zero pivot error. If I dont apply bc then it runs but of course solution is wrong. Applying the bc gives me zero pivot error.</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../3534/apply-boundary-condition-on-generalized-eigenvalue-solver?show=6220#c6220" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-12-17T10:16:09+0000"></span>Dec 17, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/praveen" class="qa-user-link url nickname">praveen</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">2,760</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516467975-984e29103a93afcaa4ba92ded5a736bc9a356e81">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>