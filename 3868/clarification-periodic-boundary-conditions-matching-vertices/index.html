<html><!-- Powered by Question2Answer - http://www.question2answer.org/ --><head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>Clarification on periodic boundary conditions (meshes with non-matching vertices and details of the map() method) - FEniCS Q&amp;A</title>
		<meta name="description" content="I have a few general questions on how to set up periodic boundary conditions. (I hope ... /possible-specify-more-than-one-periodic-boundary-condition">
		<meta name="keywords" content="periodic-bc">
		<link rel="stylesheet" type="text/css" href="../../qa-theme/Snow/qa-styles.css">
		<link rel="canonical" href="http://fenicsproject.org/qa/3868/clarification-periodic-boundary-conditions-matching-vertices">
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
    TeX: { extensions: ["AMSmath.js","AMSsymbols.js"]}
  });
</script>
<script type="text/javascript" src="../../mathjax/MathJax.js"></script>
		<script src="../../jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="../../highlight.min.js"></script>
<script type="text/javascript">
$(function(){
	$('.wmd-input').keypress(function(){
		window.clearTimeout(hljs.Timeout);
		hljs.Timeout = window.setTimeout(function() {
			hljs.initHighlighting.called = false;
			hljs.initHighlighting();
		}, 500);
	});
	window.setTimeout(function() {
		hljs.initHighlighting.called = false;
		hljs.initHighlighting();
	}, 500);
});
</script>


	</head>
	<body class="qa-template-question qa-body-js-off">
		<div class="qa-body-wrapper">
			
			<div class="qa-header">
				<div class="qa-logo">
					<a href="../../" class="qa-logo-link" title="FEniCS Q&amp;A"><img src="../../qa-theme/fenics_qa.png" border="0" alt="FEniCS Q&amp;A"></a>
				</div>
				<div class="qa-header-clear">
				</div>
			</div> <!-- END qa-header -->
			
			<div class="qa-main-shadow">
				
				<div class="qa-main-wrapper">
					
					<div class="qa-sidepanel">
						<div class="qa-sidebar">
							This is a read only copy of the old FEniCS QA forum. Please visit the <a href="https://www.allanswered.com/community/s/fenics-project/">new QA forum</a> to ask questions
						</div>
						
					</div>
					
					<div class="qa-main">
						<h1>
							<span class="entry-title">Clarification on periodic boundary conditions (meshes with non-matching vertices and details of the map() method)</span>
						</h1>
						<div class="qa-part-q-view">
							<div class="qa-q-view  hentry question" id="q3868">
								<form method="post" action="../../3868/clarification-periodic-boundary-conditions-matching-vertices">
									<div class="qa-q-view-stats">
										<div class="qa-voting qa-voting-net" id="voting_3868">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">+2<span class="votes-up"><span class="value-title" title="2"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
									</div>
									<input type="hidden" name="code" value="0-1516467989-29cb86b341dd18149656618abbf8dc9bc0025054">
								</form>
								<div class="qa-q-view-main">
									<form method="post" action="../../3868/clarification-periodic-boundary-conditions-matching-vertices">
										<div class="qa-q-view-content">
											<a name="3868"></a><div class="entry-content"><p>I have a few general questions on how to set up periodic boundary conditions. (I hope it is ok to post these together in a single question in this forum; otherwise I'm happy to ask them separately.)</p>

<p>Let's assume I have a rectangular domain represented by an irregular mesh and I'd like to apply PBCs in x-direction, i.e. identify the left and right sides of the domain. However, due to the irregularity of the mesh there is no exact correspondence between the vertices on the left boundary and those on the right boundary. From looking at the <a rel="nofollow" href="http://fenicsproject.org/documentation/dolfin/dev/python/demo/documented/periodic/python/documentation.html">Poisson demo with PBCs</a> this does not seem to matter. However, the answer to <a rel="nofollow" href="http://fenicsproject.org/qa/1823/possible-implement-curved-periodic-boundaries-like-freefem">this question</a> seems to imply that such a correspondence must exist. So my first question is: do I need to take care that mesh vertices on the periodic boundaries match up? Or is dolfin clever enough to deal with general meshes?</p>

<p>Secondly, which cases does the <code>map()</code> method of my <code>PeriodicBoundary</code> class need to cover? In particular, for which vertices will it be called? I would have thought that it is only called for the vertices on the boundary that are to be identified with the other side (e.g. the vertices on the right bounday in the rectangular domain). However, adding print statements to my map() function shows that it is called for many more vertices, including ones that lie <em>inside</em> the domain. So my second question is: what should those points be mapped to? In the answer to <a rel="nofollow" href="http://fenicsproject.org/qa/262/possible-specify-more-than-one-periodic-boundary-condition">this question</a> there are two examples, where the first one shows a mapping to some invalid values (here: -1000) whereas the second one doesn't even cover that case. So I'm a bit confused what needs to be mapped and where. Any clarification would be much appreciated. Many thanks!</p>
</div>
										</div>
										<div class="qa-q-view-tags">
											<ul class="qa-q-view-tag-list">
												<li class="qa-q-view-tag-item"><a href="../../tag/periodic-bc" rel="tag" class="qa-tag-link">periodic-bc</a></li>
											</ul>
										</div>
										<span class="qa-q-view-avatar-meta">
											<span class="qa-q-view-meta">
												<a href="../../3868/clarification-periodic-boundary-conditions-matching-vertices" class="qa-q-view-what">asked</a>
												<span class="qa-q-view-when">
													<span class="qa-q-view-when-data"><span class="published"><span class="value-title" title="2014-06-14T02:34:23+0000"></span>Jun 14, 2014</span></span>
												</span>
												<span class="qa-q-view-who">
													<span class="qa-q-view-who-pad">by </span>
													<span class="qa-q-view-who-data"><span class="vcard author"><a href="../../user/Maximilian+Albert" class="qa-user-link url nickname">Maximilian Albert</a></span></span>
													<span class="qa-q-view-who-title">FEniCS User</span>
													<span class="qa-q-view-who-points">
														<span class="qa-q-view-who-points-pad">(</span><span class="qa-q-view-who-points-data">1,750</span><span class="qa-q-view-who-points-pad"> points)</span>
													</span>
												</span>
											</span>
										</span>
										<div class="qa-q-view-buttons">
										</div>
										
										<div class="qa-q-view-c-list" style="display:none;" id="c3868_list">
										</div> <!-- END qa-c-list -->
										
										<input type="hidden" name="code" value="0-1516467989-f7a061109f3883e64d86eb03929d20b226b62d1f">
										<input type="hidden" name="qa_click" value="">
									</form>
									<div class="qa-c-form">
									</div> <!-- END qa-c-form -->
									
								</div> <!-- END qa-q-view-main -->
								<div class="qa-q-view-clear">
								</div>
							</div> <!-- END qa-q-view -->
							
						</div>
						<div class="qa-part-a-list">
							<h2 id="a_list_title">1 Answer</h2>
							<div class="qa-a-list" id="a_list">
								
								<div class="qa-a-list-item  hentry answer answer-selected qa-a-list-item-selected" id="a3955">
									<form method="post" action="../../3868/clarification-periodic-boundary-conditions-matching-vertices">
										<div class="qa-voting qa-voting-net" id="voting_3955">
											<div class="qa-vote-count qa-vote-count-net">
												<span class="qa-netvote-count">
													<span class="qa-netvote-count-data">0<span class="votes-up"><span class="value-title" title="0"></span></span><span class="votes-down"><span class="value-title" title="0"></span></span></span><span class="qa-netvote-count-pad"> votes</span>
												</span>
											</div>
											<div class="qa-vote-clear">
											</div>
										</div>
										<input type="hidden" name="code" value="0-1516467989-29cb86b341dd18149656618abbf8dc9bc0025054">
									</form>
									<div class="qa-a-item-main">
										<form method="post" action="../../3868/clarification-periodic-boundary-conditions-matching-vertices">
											<div class="qa-a-item-selected">
												<div class="qa-a-selection">
													<div class="qa-a-selected">&#160;</div>
													<div class="qa-a-selected-text">Best answer</div>
												</div>
												<div class="qa-a-item-content">
													<a name="3955"></a><div class="entry-content"><p>The vertices on periodic boundaries need to match up.</p>

<p>The <code>map</code> for periodic boundary conditions needs to match facets (checked using the midpoint). This should would fine for polygons. It can lead to problems when approximating other shapes where you want to constrain dofs to each other.  </p>
</div>
												</div>
												<span class="qa-a-item-avatar-meta">
													<span class="qa-a-item-meta">
														<a href="../../3868/clarification-periodic-boundary-conditions-matching-vertices?show=3955#a3955" class="qa-a-item-what">answered</a>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="published"><span class="value-title" title="2014-06-23T20:57:23+0000"></span>Jun 23, 2014</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span>
															<span class="qa-a-item-who-data"><span class="vcard author"><a href="../../user/Garth+N.+Wells" class="qa-user-link url nickname">Garth N. Wells</a></span></span>
															<span class="qa-a-item-who-title">FEniCS Expert</span>
															<span class="qa-a-item-who-points">
																<span class="qa-a-item-who-points-pad">(</span><span class="qa-a-item-who-points-data">35,930</span><span class="qa-a-item-who-points-pad"> points)</span>
															</span>
														</span>
														<br>
														<span class="qa-a-item-what">selected</span>
														<span class="qa-a-item-when">
															<span class="qa-a-item-when-data"><span class="updated"><span class="value-title" title="2014-06-24T08:23:44+0000"></span>Jun 24, 2014</span></span>
														</span>
														<span class="qa-a-item-who">
															<span class="qa-a-item-who-pad">by </span><span class="qa-a-item-who-data"><a href="../../user/Maximilian+Albert" class="qa-user-link url nickname">Maximilian Albert</a></span>
														</span>
													</span>
												</span>
											</div>
											<div class="qa-a-item-buttons">
												</div>
											
											<div class="qa-a-item-c-list" id="c3955_list">
												<div class="qa-c-list-item  hentry comment" id="c3969">
													<div class="qa-c-item-content">
														<a name="3969"></a><div class="entry-content"><p>Many thanks Garth!</p>
</div>
													</div>
													<div class="qa-c-item-footer">
														<span class="qa-c-item-avatar-meta">
															<span class="qa-c-item-meta">
																<a href="../../3868/clarification-periodic-boundary-conditions-matching-vertices?show=3969#c3969" class="qa-c-item-what">commented</a>
																<span class="qa-c-item-when">
																	<span class="qa-c-item-when-data"><span class="published"><span class="value-title" title="2014-06-24T12:51:50+0000"></span>Jun 24, 2014</span></span>
																</span>
																<span class="qa-c-item-who">
																	<span class="qa-c-item-who-pad">by </span>
																	<span class="qa-c-item-who-data"><span class="vcard author"><a href="../../user/Maximilian+Albert" class="qa-user-link url nickname">Maximilian Albert</a></span></span>
																	<span class="qa-c-item-who-title">FEniCS User</span>
																	<span class="qa-c-item-who-points">
																		<span class="qa-c-item-who-points-pad">(</span><span class="qa-c-item-who-points-data">1,750</span><span class="qa-c-item-who-points-pad"> points)</span>
																	</span>
																</span>
															</span>
														</span>
														<div class="qa-c-item-buttons">
														</div>
													</div>
													<div class="qa-c-item-clear">
													</div>
												</div> <!-- END qa-c-item -->
											</div> <!-- END qa-c-list -->
											
											<input type="hidden" name="code" value="0-1516467989-b186691d9749876468de80636283e1e15b4b3417">
											<input type="hidden" name="qa_click" value="">
										</form>
										<div class="qa-c-form">
										</div> <!-- END qa-c-form -->
										
									</div> <!-- END qa-a-item-main -->
									<div class="qa-a-item-clear">
									</div>
								</div> <!-- END qa-a-list-item -->
								
							</div> <!-- END qa-a-list -->
							
						</div>
					</div> <!-- END qa-main -->
					
				</div> <!-- END main-wrapper -->
			</div> <!-- END main-shadow -->
		</div> <!-- END body-wrapper -->
		<!-- END footer-bottom-group -->
		
		<div style="position:absolute; left:-9999px; top:-9999px;">
			<span id="qa-waiting-template" class="qa-waiting">...</span>
		</div>
	
	

</body><!-- Powered by Question2Answer - http://www.question2answer.org/ --></html>